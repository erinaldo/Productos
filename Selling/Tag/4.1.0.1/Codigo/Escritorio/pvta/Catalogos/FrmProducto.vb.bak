Imports System.IO

Public Class FrmProducto
    Inherits System.Windows.Forms.Form

#Region " Windows Form Designer generated code "

    Public Sub New()
        MyBase.New()

        'This call is required by the Windows Form Designer.
        InitializeComponent()

        'Add any initialization after the InitializeComponent() call

    End Sub

    'Form overrides dispose to clean up the component list.
    Protected Overloads Overrides Sub Dispose(ByVal disposing As Boolean)
        If disposing Then
            If Not (components Is Nothing) Then
                components.Dispose()
            End If
        End If
        MyBase.Dispose(disposing)
    End Sub

    'Required by the Windows Form Designer
    Private components As System.ComponentModel.IContainer

    'NOTE: The following procedure is required by the Windows Form Designer
    'It can be modified using the Windows Form Designer.  
    'Do not modify it using the code editor.
    Friend WithEvents UiTab1 As Janus.Windows.UI.Tab.UITab
    Friend WithEvents BtnCancelar As Janus.Windows.EditControls.UIButton
    Friend WithEvents BtnGuardar As Janus.Windows.EditControls.UIButton
    Friend WithEvents GrpCostHist As System.Windows.Forms.GroupBox
    Friend WithEvents GridCostHist As Janus.Windows.GridEX.GridEX
    Friend WithEvents UiTabProducto As Janus.Windows.UI.Tab.UITabPage
    Friend WithEvents UiTabCosto As Janus.Windows.UI.Tab.UITabPage
    Friend WithEvents UiTabEquivalentes As Janus.Windows.UI.Tab.UITabPage
    Friend WithEvents GrpEquivalentes As System.Windows.Forms.GroupBox
    Friend WithEvents BtnDelEquivalente As Janus.Windows.EditControls.UIButton
    Friend WithEvents BtnAddEquivalente As Janus.Windows.EditControls.UIButton
    Friend WithEvents GridEquivalentes As Janus.Windows.GridEX.GridEX
    Friend WithEvents OpenFileDialog1 As System.Windows.Forms.OpenFileDialog
    Friend WithEvents Panel1 As System.Windows.Forms.Panel
    Friend WithEvents GrpProd As System.Windows.Forms.GroupBox
    Friend WithEvents ChkEstado As Selling.ChkStatus
    Friend WithEvents lblCosto As System.Windows.Forms.Label
    Friend WithEvents PictureBox1 As System.Windows.Forms.PictureBox
    Friend WithEvents TxtDescripcion As System.Windows.Forms.TextBox
    Friend WithEvents Label11 As System.Windows.Forms.Label
    Friend WithEvents TxtNombre As System.Windows.Forms.TextBox
    Friend WithEvents LblNombre As System.Windows.Forms.Label
    Friend WithEvents LblClave As System.Windows.Forms.Label
    Friend WithEvents TxtClave As System.Windows.Forms.TextBox
    Friend WithEvents GrpMultiproducto As System.Windows.Forms.GroupBox
    Friend WithEvents BtnModProd As Janus.Windows.EditControls.UIButton
    Friend WithEvents BtnDelProd As Janus.Windows.EditControls.UIButton
    Friend WithEvents BtnAddProd As Janus.Windows.EditControls.UIButton
    Friend WithEvents GridMultiproducto As Janus.Windows.GridEX.GridEX
    Friend WithEvents TxtNumParte As System.Windows.Forms.TextBox
    Friend WithEvents GrpCosto As System.Windows.Forms.GroupBox
    Friend WithEvents Label3 As System.Windows.Forms.Label
    Friend WithEvents Label4 As System.Windows.Forms.Label
    Friend WithEvents Label5 As System.Windows.Forms.Label
    Friend WithEvents CmbSubLinea As Selling.StoreCombo
    Friend WithEvents CmbLinea As Selling.StoreCombo
    Friend WithEvents CmbMarca As Selling.StoreCombo
    Friend WithEvents GrpPrecios As System.Windows.Forms.GroupBox
    Friend WithEvents UiTabKits As Janus.Windows.UI.Tab.UITabPage
    Friend WithEvents cmbCosto As Selling.StoreCombo
    Friend WithEvents LblMetodo As System.Windows.Forms.Label
    Friend WithEvents Label1 As System.Windows.Forms.Label
    Friend WithEvents TxtCost As Janus.Windows.GridEX.EditControls.NumericEditBox
    Friend WithEvents PictureBox4 As System.Windows.Forms.PictureBox
    Friend WithEvents GrpUnidades As System.Windows.Forms.GroupBox
    Friend WithEvents BtnDelUnidad As Janus.Windows.EditControls.UIButton
    Friend WithEvents GridUnidades As Janus.Windows.GridEX.GridEX
    Friend WithEvents PictureBox5 As System.Windows.Forms.PictureBox
    Friend WithEvents PictureBox6 As System.Windows.Forms.PictureBox
    Friend WithEvents PictureBox7 As System.Windows.Forms.PictureBox
    Friend WithEvents GridPrecios As Janus.Windows.GridEX.GridEX
    Friend WithEvents PictureBox8 As System.Windows.Forms.PictureBox
    Friend WithEvents PictureBox9 As System.Windows.Forms.PictureBox
    Friend WithEvents CmbSeguimiento As Selling.StoreCombo
    Friend WithEvents TxtDiasGarantia As Janus.Windows.GridEX.EditControls.NumericEditBox
    Friend WithEvents Label6 As System.Windows.Forms.Label
    Friend WithEvents PictureBox11 As System.Windows.Forms.PictureBox
    Friend WithEvents BtnReemplazo As Janus.Windows.EditControls.UIButton
    Friend WithEvents BtnKey As Janus.Windows.EditControls.UIButton
    Friend WithEvents GrpPrv As System.Windows.Forms.GroupBox
    Friend WithEvents BtnAddPrv As Janus.Windows.EditControls.UIButton
    Friend WithEvents GridPrv As Janus.Windows.GridEX.GridEX
    Friend WithEvents BtnModificar As Janus.Windows.EditControls.UIButton
    Friend WithEvents GroupBox5 As System.Windows.Forms.GroupBox
    Friend WithEvents PictureBox3 As System.Windows.Forms.PictureBox
    Friend WithEvents GroupBox4 As System.Windows.Forms.GroupBox
    Friend WithEvents PictureBox14 As System.Windows.Forms.PictureBox
    Friend WithEvents PictureBox13 As System.Windows.Forms.PictureBox
    Friend WithEvents PictureBox12 As System.Windows.Forms.PictureBox
    Friend WithEvents NumMaximo As Janus.Windows.GridEX.EditControls.NumericEditBox
    Friend WithEvents Label13 As System.Windows.Forms.Label
    Friend WithEvents NumReorden As Janus.Windows.GridEX.EditControls.NumericEditBox
    Friend WithEvents Label8 As System.Windows.Forms.Label
    Friend WithEvents NumMinimo As Janus.Windows.GridEX.EditControls.NumericEditBox
    Friend WithEvents Label7 As System.Windows.Forms.Label
    Friend WithEvents GrpImpuestos As System.Windows.Forms.GroupBox
    Friend WithEvents ChkMarcaTodos As System.Windows.Forms.CheckBox
    Friend WithEvents PictureBox16 As System.Windows.Forms.PictureBox
    Friend WithEvents Label14 As System.Windows.Forms.Label
    Friend WithEvents CmbTipo As Selling.StoreCombo
    Friend WithEvents NumDec As System.Windows.Forms.NumericUpDown
    Friend WithEvents PictureBox2 As System.Windows.Forms.PictureBox
    Friend WithEvents Label9 As System.Windows.Forms.Label
    Friend WithEvents PictureBox15 As System.Windows.Forms.PictureBox
    Friend WithEvents Label12 As System.Windows.Forms.Label
    Friend WithEvents Label15 As System.Windows.Forms.Label
    Friend WithEvents CmbOrigen As Selling.StoreCombo
    Friend WithEvents CmbTipoComision As Selling.StoreCombo
    Friend WithEvents CmbRotacion As Selling.StoreCombo
    Friend WithEvents Label2 As System.Windows.Forms.Label
    Friend WithEvents GroupBox6 As System.Windows.Forms.GroupBox
    Friend WithEvents PicProducto As System.Windows.Forms.PictureBox
    Friend WithEvents BtnAddUnidad As Janus.Windows.EditControls.UIButton
    Friend WithEvents BtnCosto As Janus.Windows.EditControls.UIButton
    Friend WithEvents GridImpuestos As Janus.Windows.GridEX.GridEX
    Friend WithEvents TxtNota As System.Windows.Forms.TextBox
    Friend WithEvents Label16 As System.Windows.Forms.Label
    Friend WithEvents TxtCompany As System.Windows.Forms.TextBox
    Friend WithEvents Label18 As System.Windows.Forms.Label
    Friend WithEvents Label17 As System.Windows.Forms.Label
    <System.Diagnostics.DebuggerStepThrough()> Private Sub InitializeComponent()
        Me.components = New System.ComponentModel.Container
        Dim resources As System.ComponentModel.ComponentResourceManager = New System.ComponentModel.ComponentResourceManager(GetType(FrmProducto))
        Me.UiTab1 = New Janus.Windows.UI.Tab.UITab
        Me.UiTabProducto = New Janus.Windows.UI.Tab.UITabPage
        Me.Panel1 = New System.Windows.Forms.Panel
        Me.GroupBox6 = New System.Windows.Forms.GroupBox
        Me.PicProducto = New System.Windows.Forms.PictureBox
        Me.GroupBox5 = New System.Windows.Forms.GroupBox
        Me.Label6 = New System.Windows.Forms.Label
        Me.TxtDiasGarantia = New Janus.Windows.GridEX.EditControls.NumericEditBox
        Me.PictureBox11 = New System.Windows.Forms.PictureBox
        Me.CmbSeguimiento = New Selling.StoreCombo
        Me.PictureBox3 = New System.Windows.Forms.PictureBox
        Me.GroupBox4 = New System.Windows.Forms.GroupBox
        Me.PictureBox14 = New System.Windows.Forms.PictureBox
        Me.PictureBox13 = New System.Windows.Forms.PictureBox
        Me.PictureBox12 = New System.Windows.Forms.PictureBox
        Me.NumMaximo = New Janus.Windows.GridEX.EditControls.NumericEditBox
        Me.Label13 = New System.Windows.Forms.Label
        Me.NumReorden = New Janus.Windows.GridEX.EditControls.NumericEditBox
        Me.Label8 = New System.Windows.Forms.Label
        Me.NumMinimo = New Janus.Windows.GridEX.EditControls.NumericEditBox
        Me.Label7 = New System.Windows.Forms.Label
        Me.GrpImpuestos = New System.Windows.Forms.GroupBox
        Me.GridImpuestos = New Janus.Windows.GridEX.GridEX
        Me.ChkMarcaTodos = New System.Windows.Forms.CheckBox
        Me.Label14 = New System.Windows.Forms.Label
        Me.CmbTipo = New Selling.StoreCombo
        Me.NumDec = New System.Windows.Forms.NumericUpDown
        Me.PictureBox2 = New System.Windows.Forms.PictureBox
        Me.Label9 = New System.Windows.Forms.Label
        Me.PictureBox15 = New System.Windows.Forms.PictureBox
        Me.Label12 = New System.Windows.Forms.Label
        Me.Label15 = New System.Windows.Forms.Label
        Me.CmbOrigen = New Selling.StoreCombo
        Me.CmbTipoComision = New Selling.StoreCombo
        Me.CmbRotacion = New Selling.StoreCombo
        Me.Label2 = New System.Windows.Forms.Label
        Me.Label17 = New System.Windows.Forms.Label
        Me.GrpProd = New System.Windows.Forms.GroupBox
        Me.TxtCompany = New System.Windows.Forms.TextBox
        Me.Label18 = New System.Windows.Forms.Label
        Me.TxtNota = New System.Windows.Forms.TextBox
        Me.Label16 = New System.Windows.Forms.Label
        Me.PictureBox4 = New System.Windows.Forms.PictureBox
        Me.PictureBox1 = New System.Windows.Forms.PictureBox
        Me.BtnKey = New Janus.Windows.EditControls.UIButton
        Me.PictureBox5 = New System.Windows.Forms.PictureBox
        Me.GrpUnidades = New System.Windows.Forms.GroupBox
        Me.BtnAddUnidad = New Janus.Windows.EditControls.UIButton
        Me.PictureBox8 = New System.Windows.Forms.PictureBox
        Me.BtnDelUnidad = New Janus.Windows.EditControls.UIButton
        Me.GridUnidades = New Janus.Windows.GridEX.GridEX
        Me.GrpPrecios = New System.Windows.Forms.GroupBox
        Me.GridPrecios = New Janus.Windows.GridEX.GridEX
        Me.PictureBox9 = New System.Windows.Forms.PictureBox
        Me.Label5 = New System.Windows.Forms.Label
        Me.CmbSubLinea = New Selling.StoreCombo
        Me.Label4 = New System.Windows.Forms.Label
        Me.CmbLinea = New Selling.StoreCombo
        Me.Label3 = New System.Windows.Forms.Label
        Me.CmbMarca = New Selling.StoreCombo
        Me.TxtNumParte = New System.Windows.Forms.TextBox
        Me.GrpCosto = New System.Windows.Forms.GroupBox
        Me.BtnCosto = New Janus.Windows.EditControls.UIButton
        Me.cmbCosto = New Selling.StoreCombo
        Me.PictureBox16 = New System.Windows.Forms.PictureBox
        Me.TxtCost = New Janus.Windows.GridEX.EditControls.NumericEditBox
        Me.PictureBox6 = New System.Windows.Forms.PictureBox
        Me.PictureBox7 = New System.Windows.Forms.PictureBox
        Me.Label1 = New System.Windows.Forms.Label
        Me.LblMetodo = New System.Windows.Forms.Label
        Me.ChkEstado = New Selling.ChkStatus(Me.components)
        Me.lblCosto = New System.Windows.Forms.Label
        Me.TxtDescripcion = New System.Windows.Forms.TextBox
        Me.Label11 = New System.Windows.Forms.Label
        Me.TxtNombre = New System.Windows.Forms.TextBox
        Me.LblNombre = New System.Windows.Forms.Label
        Me.LblClave = New System.Windows.Forms.Label
        Me.TxtClave = New System.Windows.Forms.TextBox
        Me.UiTabKits = New Janus.Windows.UI.Tab.UITabPage
        Me.GrpMultiproducto = New System.Windows.Forms.GroupBox
        Me.BtnModProd = New Janus.Windows.EditControls.UIButton
        Me.BtnDelProd = New Janus.Windows.EditControls.UIButton
        Me.BtnAddProd = New Janus.Windows.EditControls.UIButton
        Me.GridMultiproducto = New Janus.Windows.GridEX.GridEX
        Me.UiTabEquivalentes = New Janus.Windows.UI.Tab.UITabPage
        Me.GrpEquivalentes = New System.Windows.Forms.GroupBox
        Me.BtnDelEquivalente = New Janus.Windows.EditControls.UIButton
        Me.BtnAddEquivalente = New Janus.Windows.EditControls.UIButton
        Me.GridEquivalentes = New Janus.Windows.GridEX.GridEX
        Me.UiTabCosto = New Janus.Windows.UI.Tab.UITabPage
        Me.GrpPrv = New System.Windows.Forms.GroupBox
        Me.GridPrv = New Janus.Windows.GridEX.GridEX
        Me.BtnModificar = New Janus.Windows.EditControls.UIButton
        Me.BtnAddPrv = New Janus.Windows.EditControls.UIButton
        Me.GrpCostHist = New System.Windows.Forms.GroupBox
        Me.GridCostHist = New Janus.Windows.GridEX.GridEX
        Me.BtnReemplazo = New Janus.Windows.EditControls.UIButton
        Me.OpenFileDialog1 = New System.Windows.Forms.OpenFileDialog
        Me.BtnGuardar = New Janus.Windows.EditControls.UIButton
        Me.BtnCancelar = New Janus.Windows.EditControls.UIButton
        CType(Me.UiTab1, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.UiTab1.SuspendLayout()
        Me.UiTabProducto.SuspendLayout()
        Me.Panel1.SuspendLayout()
        Me.GroupBox6.SuspendLayout()
        CType(Me.PicProducto, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.GroupBox5.SuspendLayout()
        CType(Me.PictureBox11, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.PictureBox3, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.GroupBox4.SuspendLayout()
        CType(Me.PictureBox14, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.PictureBox13, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.PictureBox12, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.GrpImpuestos.SuspendLayout()
        CType(Me.GridImpuestos, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.NumDec, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.PictureBox2, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.PictureBox15, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.GrpProd.SuspendLayout()
        CType(Me.PictureBox4, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.PictureBox1, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.PictureBox5, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.GrpUnidades.SuspendLayout()
        CType(Me.PictureBox8, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.GridUnidades, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.GrpPrecios.SuspendLayout()
        CType(Me.GridPrecios, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.PictureBox9, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.GrpCosto.SuspendLayout()
        CType(Me.PictureBox16, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.PictureBox6, System.ComponentModel.ISupportInitialize).BeginInit()
        CType(Me.PictureBox7, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.UiTabKits.SuspendLayout()
        Me.GrpMultiproducto.SuspendLayout()
        CType(Me.GridMultiproducto, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.UiTabEquivalentes.SuspendLayout()
        Me.GrpEquivalentes.SuspendLayout()
        CType(Me.GridEquivalentes, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.UiTabCosto.SuspendLayout()
        Me.GrpPrv.SuspendLayout()
        CType(Me.GridPrv, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.GrpCostHist.SuspendLayout()
        CType(Me.GridCostHist, System.ComponentModel.ISupportInitialize).BeginInit()
        Me.SuspendLayout()
        '
        'UiTab1
        '
        Me.UiTab1.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.UiTab1.Location = New System.Drawing.Point(1, 1)
        Me.UiTab1.Name = "UiTab1"
        Me.UiTab1.Size = New System.Drawing.Size(781, 518)
        Me.UiTab1.TabIndex = 0
        Me.UiTab1.TabPages.AddRange(New Janus.Windows.UI.Tab.UITabPage() {Me.UiTabProducto, Me.UiTabKits, Me.UiTabEquivalentes, Me.UiTabCosto})
        Me.UiTab1.VisualStyle = Janus.Windows.UI.Tab.TabVisualStyle.Office2007
        '
        'UiTabProducto
        '
        Me.UiTabProducto.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.UiTabProducto.Controls.Add(Me.Panel1)
        Me.UiTabProducto.Location = New System.Drawing.Point(1, 24)
        Me.UiTabProducto.Name = "UiTabProducto"
        Me.UiTabProducto.Size = New System.Drawing.Size(779, 493)
        Me.UiTabProducto.TabStop = True
        Me.UiTabProducto.Text = "General"
        '
        'Panel1
        '
        Me.Panel1.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.Panel1.AutoScroll = True
        Me.Panel1.BackColor = System.Drawing.Color.Transparent
        Me.Panel1.Controls.Add(Me.GroupBox6)
        Me.Panel1.Controls.Add(Me.GroupBox5)
        Me.Panel1.Controls.Add(Me.GrpProd)
        Me.Panel1.Location = New System.Drawing.Point(0, -1)
        Me.Panel1.Name = "Panel1"
        Me.Panel1.Size = New System.Drawing.Size(775, 494)
        Me.Panel1.TabIndex = 3
        '
        'GroupBox6
        '
        Me.GroupBox6.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GroupBox6.Controls.Add(Me.PicProducto)
        Me.GroupBox6.Location = New System.Drawing.Point(428, 2)
        Me.GroupBox6.Name = "GroupBox6"
        Me.GroupBox6.Size = New System.Drawing.Size(328, 318)
        Me.GroupBox6.TabIndex = 103
        Me.GroupBox6.TabStop = False
        Me.GroupBox6.Text = "Imagen"
        '
        'PicProducto
        '
        Me.PicProducto.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.PicProducto.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle
        Me.PicProducto.Cursor = System.Windows.Forms.Cursors.Hand
        Me.PicProducto.Location = New System.Drawing.Point(6, 18)
        Me.PicProducto.Name = "PicProducto"
        Me.PicProducto.Size = New System.Drawing.Size(317, 293)
        Me.PicProducto.SizeMode = System.Windows.Forms.PictureBoxSizeMode.StretchImage
        Me.PicProducto.TabIndex = 54
        Me.PicProducto.TabStop = False
        '
        'GroupBox5
        '
        Me.GroupBox5.Anchor = CType(((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GroupBox5.Controls.Add(Me.Label6)
        Me.GroupBox5.Controls.Add(Me.TxtDiasGarantia)
        Me.GroupBox5.Controls.Add(Me.PictureBox11)
        Me.GroupBox5.Controls.Add(Me.CmbSeguimiento)
        Me.GroupBox5.Controls.Add(Me.PictureBox3)
        Me.GroupBox5.Controls.Add(Me.GroupBox4)
        Me.GroupBox5.Controls.Add(Me.GrpImpuestos)
        Me.GroupBox5.Controls.Add(Me.Label14)
        Me.GroupBox5.Controls.Add(Me.CmbTipo)
        Me.GroupBox5.Controls.Add(Me.NumDec)
        Me.GroupBox5.Controls.Add(Me.PictureBox2)
        Me.GroupBox5.Controls.Add(Me.Label9)
        Me.GroupBox5.Controls.Add(Me.PictureBox15)
        Me.GroupBox5.Controls.Add(Me.Label12)
        Me.GroupBox5.Controls.Add(Me.Label15)
        Me.GroupBox5.Controls.Add(Me.CmbOrigen)
        Me.GroupBox5.Controls.Add(Me.CmbTipoComision)
        Me.GroupBox5.Controls.Add(Me.CmbRotacion)
        Me.GroupBox5.Controls.Add(Me.Label2)
        Me.GroupBox5.Controls.Add(Me.Label17)
        Me.GroupBox5.Location = New System.Drawing.Point(429, 321)
        Me.GroupBox5.Name = "GroupBox5"
        Me.GroupBox5.Size = New System.Drawing.Size(328, 31449)
        Me.GroupBox5.TabIndex = 2
        Me.GroupBox5.TabStop = False
        Me.GroupBox5.Text = "Configuración"
        '
        'Label6
        '
        Me.Label6.Location = New System.Drawing.Point(5, 177)
        Me.Label6.Name = "Label6"
        Me.Label6.Size = New System.Drawing.Size(143, 16)
        Me.Label6.TabIndex = 84
        Me.Label6.Text = "Días de Garantía"
        '
        'TxtDiasGarantia
        '
        Me.TxtDiasGarantia.Enabled = False
        Me.TxtDiasGarantia.Location = New System.Drawing.Point(228, 172)
        Me.TxtDiasGarantia.Name = "TxtDiasGarantia"
        Me.TxtDiasGarantia.Size = New System.Drawing.Size(66, 21)
        Me.TxtDiasGarantia.TabIndex = 83
        Me.TxtDiasGarantia.Text = "0"
        Me.TxtDiasGarantia.TextAlignment = Janus.Windows.GridEX.TextAlignment.Center
        Me.TxtDiasGarantia.Value = 0
        Me.TxtDiasGarantia.ValueType = Janus.Windows.GridEX.NumericEditValueType.Int32
        '
        'PictureBox11
        '
        Me.PictureBox11.Image = CType(resources.GetObject("PictureBox11.Image"), System.Drawing.Image)
        Me.PictureBox11.Location = New System.Drawing.Point(57, 146)
        Me.PictureBox11.Name = "PictureBox11"
        Me.PictureBox11.Size = New System.Drawing.Size(16, 16)
        Me.PictureBox11.TabIndex = 85
        Me.PictureBox11.TabStop = False
        Me.PictureBox11.Visible = False
        '
        'CmbSeguimiento
        '
        Me.CmbSeguimiento.Location = New System.Drawing.Point(124, 144)
        Me.CmbSeguimiento.Name = "CmbSeguimiento"
        Me.CmbSeguimiento.Size = New System.Drawing.Size(170, 24)
        Me.CmbSeguimiento.TabIndex = 7
        '
        'PictureBox3
        '
        Me.PictureBox3.Image = CType(resources.GetObject("PictureBox3.Image"), System.Drawing.Image)
        Me.PictureBox3.Location = New System.Drawing.Point(54, 53)
        Me.PictureBox3.Name = "PictureBox3"
        Me.PictureBox3.Size = New System.Drawing.Size(16, 16)
        Me.PictureBox3.TabIndex = 35
        Me.PictureBox3.TabStop = False
        Me.PictureBox3.Visible = False
        '
        'GroupBox4
        '
        Me.GroupBox4.Controls.Add(Me.PictureBox14)
        Me.GroupBox4.Controls.Add(Me.PictureBox13)
        Me.GroupBox4.Controls.Add(Me.PictureBox12)
        Me.GroupBox4.Controls.Add(Me.NumMaximo)
        Me.GroupBox4.Controls.Add(Me.Label13)
        Me.GroupBox4.Controls.Add(Me.NumReorden)
        Me.GroupBox4.Controls.Add(Me.Label8)
        Me.GroupBox4.Controls.Add(Me.NumMinimo)
        Me.GroupBox4.Controls.Add(Me.Label7)
        Me.GroupBox4.Location = New System.Drawing.Point(10, 413)
        Me.GroupBox4.Name = "GroupBox4"
        Me.GroupBox4.Size = New System.Drawing.Size(284, 118)
        Me.GroupBox4.TabIndex = 102
        Me.GroupBox4.TabStop = False
        Me.GroupBox4.Text = "Inventario"
        '
        'PictureBox14
        '
        Me.PictureBox14.Image = CType(resources.GetObject("PictureBox14.Image"), System.Drawing.Image)
        Me.PictureBox14.Location = New System.Drawing.Point(85, 92)
        Me.PictureBox14.Name = "PictureBox14"
        Me.PictureBox14.Size = New System.Drawing.Size(16, 16)
        Me.PictureBox14.TabIndex = 100
        Me.PictureBox14.TabStop = False
        Me.PictureBox14.Visible = False
        '
        'PictureBox13
        '
        Me.PictureBox13.Image = CType(resources.GetObject("PictureBox13.Image"), System.Drawing.Image)
        Me.PictureBox13.Location = New System.Drawing.Point(87, 59)
        Me.PictureBox13.Name = "PictureBox13"
        Me.PictureBox13.Size = New System.Drawing.Size(16, 16)
        Me.PictureBox13.TabIndex = 99
        Me.PictureBox13.TabStop = False
        Me.PictureBox13.Visible = False
        '
        'PictureBox12
        '
        Me.PictureBox12.Image = CType(resources.GetObject("PictureBox12.Image"), System.Drawing.Image)
        Me.PictureBox12.Location = New System.Drawing.Point(87, 23)
        Me.PictureBox12.Name = "PictureBox12"
        Me.PictureBox12.Size = New System.Drawing.Size(16, 16)
        Me.PictureBox12.TabIndex = 98
        Me.PictureBox12.TabStop = False
        Me.PictureBox12.Visible = False
        '
        'NumMaximo
        '
        Me.NumMaximo.Location = New System.Drawing.Point(142, 88)
        Me.NumMaximo.Name = "NumMaximo"
        Me.NumMaximo.Size = New System.Drawing.Size(106, 21)
        Me.NumMaximo.TabIndex = 96
        Me.NumMaximo.Text = "0.00"
        Me.NumMaximo.TextAlignment = Janus.Windows.GridEX.TextAlignment.Far
        Me.NumMaximo.Value = 0
        Me.NumMaximo.ValueType = Janus.Windows.GridEX.NumericEditValueType.[Double]
        '
        'Label13
        '
        Me.Label13.Location = New System.Drawing.Point(13, 92)
        Me.Label13.Name = "Label13"
        Me.Label13.Size = New System.Drawing.Size(72, 13)
        Me.Label13.TabIndex = 97
        Me.Label13.Text = "Maximo"
        '
        'NumReorden
        '
        Me.NumReorden.Location = New System.Drawing.Point(144, 55)
        Me.NumReorden.Name = "NumReorden"
        Me.NumReorden.Size = New System.Drawing.Size(105, 21)
        Me.NumReorden.TabIndex = 94
        Me.NumReorden.Text = "0.00"
        Me.NumReorden.TextAlignment = Janus.Windows.GridEX.TextAlignment.Far
        Me.NumReorden.Value = 0
        Me.NumReorden.ValueType = Janus.Windows.GridEX.NumericEditValueType.[Double]
        '
        'Label8
        '
        Me.Label8.Location = New System.Drawing.Point(12, 58)
        Me.Label8.Name = "Label8"
        Me.Label8.Size = New System.Drawing.Size(126, 18)
        Me.Label8.TabIndex = 95
        Me.Label8.Text = "Punto de Reorden"
        '
        'NumMinimo
        '
        Me.NumMinimo.Location = New System.Drawing.Point(144, 22)
        Me.NumMinimo.Name = "NumMinimo"
        Me.NumMinimo.Size = New System.Drawing.Size(103, 21)
        Me.NumMinimo.TabIndex = 92
        Me.NumMinimo.Text = "0.00"
        Me.NumMinimo.TextAlignment = Janus.Windows.GridEX.TextAlignment.Far
        Me.NumMinimo.Value = 0
        Me.NumMinimo.ValueType = Janus.Windows.GridEX.NumericEditValueType.[Double]
        '
        'Label7
        '
        Me.Label7.Location = New System.Drawing.Point(12, 28)
        Me.Label7.Name = "Label7"
        Me.Label7.Size = New System.Drawing.Size(73, 15)
        Me.Label7.TabIndex = 93
        Me.Label7.Text = "Minimo"
        '
        'GrpImpuestos
        '
        Me.GrpImpuestos.Controls.Add(Me.GridImpuestos)
        Me.GrpImpuestos.Controls.Add(Me.ChkMarcaTodos)
        Me.GrpImpuestos.Location = New System.Drawing.Point(11, 220)
        Me.GrpImpuestos.Name = "GrpImpuestos"
        Me.GrpImpuestos.Size = New System.Drawing.Size(284, 187)
        Me.GrpImpuestos.TabIndex = 101
        Me.GrpImpuestos.TabStop = False
        Me.GrpImpuestos.Text = "Impuestos"
        '
        'GridImpuestos
        '
        Me.GridImpuestos.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GridImpuestos.AutoEdit = True
        Me.GridImpuestos.ColumnAutoResize = True
        Me.GridImpuestos.ColumnSetNavigation = Janus.Windows.GridEX.ColumnSetNavigation.ColumnSet
        Me.GridImpuestos.Location = New System.Drawing.Point(6, 36)
        Me.GridImpuestos.Name = "GridImpuestos"
        Me.GridImpuestos.RecordNavigator = True
        Me.GridImpuestos.Size = New System.Drawing.Size(272, 145)
        Me.GridImpuestos.TabIndex = 8
        Me.GridImpuestos.UpdateMode = Janus.Windows.GridEX.UpdateMode.CellUpdate
        Me.GridImpuestos.UpdateOnLeave = False
        Me.GridImpuestos.VisualStyle = Janus.Windows.GridEX.VisualStyle.Office2007
        '
        'ChkMarcaTodos
        '
        Me.ChkMarcaTodos.Enabled = False
        Me.ChkMarcaTodos.Location = New System.Drawing.Point(7, 13)
        Me.ChkMarcaTodos.Name = "ChkMarcaTodos"
        Me.ChkMarcaTodos.Size = New System.Drawing.Size(104, 24)
        Me.ChkMarcaTodos.TabIndex = 6
        Me.ChkMarcaTodos.Text = "Marcar Todos"
        '
        'Label14
        '
        Me.Label14.Location = New System.Drawing.Point(5, 202)
        Me.Label14.Name = "Label14"
        Me.Label14.Size = New System.Drawing.Size(143, 18)
        Me.Label14.TabIndex = 96
        Me.Label14.Text = "Numero de Decimales "
        '
        'CmbTipo
        '
        Me.CmbTipo.BackColor = System.Drawing.SystemColors.Window
        Me.CmbTipo.Location = New System.Drawing.Point(125, 18)
        Me.CmbTipo.Name = "CmbTipo"
        Me.CmbTipo.Size = New System.Drawing.Size(169, 24)
        Me.CmbTipo.TabIndex = 3
        '
        'NumDec
        '
        Me.NumDec.Location = New System.Drawing.Point(228, 200)
        Me.NumDec.Maximum = New Decimal(New Integer() {4, 0, 0, 0})
        Me.NumDec.Name = "NumDec"
        Me.NumDec.Size = New System.Drawing.Size(66, 21)
        Me.NumDec.TabIndex = 10
        Me.NumDec.ThousandsSeparator = True
        '
        'PictureBox2
        '
        Me.PictureBox2.Image = CType(resources.GetObject("PictureBox2.Image"), System.Drawing.Image)
        Me.PictureBox2.Location = New System.Drawing.Point(52, 18)
        Me.PictureBox2.Name = "PictureBox2"
        Me.PictureBox2.Size = New System.Drawing.Size(16, 16)
        Me.PictureBox2.TabIndex = 52
        Me.PictureBox2.TabStop = False
        Me.PictureBox2.Visible = False
        '
        'Label9
        '
        Me.Label9.Location = New System.Drawing.Point(3, 21)
        Me.Label9.Name = "Label9"
        Me.Label9.Size = New System.Drawing.Size(93, 16)
        Me.Label9.TabIndex = 23
        Me.Label9.Text = "T. Producto"
        '
        'PictureBox15
        '
        Me.PictureBox15.BackColor = System.Drawing.Color.LightSteelBlue
        Me.PictureBox15.Image = CType(resources.GetObject("PictureBox15.Image"), System.Drawing.Image)
        Me.PictureBox15.Location = New System.Drawing.Point(54, 118)
        Me.PictureBox15.Name = "PictureBox15"
        Me.PictureBox15.Size = New System.Drawing.Size(16, 16)
        Me.PictureBox15.TabIndex = 99
        Me.PictureBox15.TabStop = False
        Me.PictureBox15.Visible = False
        '
        'Label12
        '
        Me.Label12.Location = New System.Drawing.Point(4, 52)
        Me.Label12.Name = "Label12"
        Me.Label12.Size = New System.Drawing.Size(66, 18)
        Me.Label12.TabIndex = 37
        Me.Label12.Text = "T. Origen"
        '
        'Label15
        '
        Me.Label15.Location = New System.Drawing.Point(3, 118)
        Me.Label15.Name = "Label15"
        Me.Label15.Size = New System.Drawing.Size(72, 16)
        Me.Label15.TabIndex = 98
        Me.Label15.Text = "T. Comisión"
        '
        'CmbOrigen
        '
        Me.CmbOrigen.Location = New System.Drawing.Point(125, 49)
        Me.CmbOrigen.Name = "CmbOrigen"
        Me.CmbOrigen.Size = New System.Drawing.Size(169, 24)
        Me.CmbOrigen.TabIndex = 4
        '
        'CmbTipoComision
        '
        Me.CmbTipoComision.Location = New System.Drawing.Point(125, 113)
        Me.CmbTipoComision.Name = "CmbTipoComision"
        Me.CmbTipoComision.Size = New System.Drawing.Size(169, 24)
        Me.CmbTipoComision.TabIndex = 11
        '
        'CmbRotacion
        '
        Me.CmbRotacion.Location = New System.Drawing.Point(125, 81)
        Me.CmbRotacion.Name = "CmbRotacion"
        Me.CmbRotacion.Size = New System.Drawing.Size(169, 24)
        Me.CmbRotacion.TabIndex = 9
        '
        'Label2
        '
        Me.Label2.Location = New System.Drawing.Point(4, 84)
        Me.Label2.Name = "Label2"
        Me.Label2.Size = New System.Drawing.Size(80, 16)
        Me.Label2.TabIndex = 55
        Me.Label2.Text = "T. Rotación"
        '
        'Label17
        '
        Me.Label17.Location = New System.Drawing.Point(2, 149)
        Me.Label17.Name = "Label17"
        Me.Label17.Size = New System.Drawing.Size(69, 13)
        Me.Label17.TabIndex = 103
        Me.Label17.Text = "Seguimiento"
        '
        'GrpProd
        '
        Me.GrpProd.Anchor = CType(((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GrpProd.BackColor = System.Drawing.Color.Transparent
        Me.GrpProd.Controls.Add(Me.TxtCompany)
        Me.GrpProd.Controls.Add(Me.Label18)
        Me.GrpProd.Controls.Add(Me.TxtNota)
        Me.GrpProd.Controls.Add(Me.Label16)
        Me.GrpProd.Controls.Add(Me.PictureBox4)
        Me.GrpProd.Controls.Add(Me.PictureBox1)
        Me.GrpProd.Controls.Add(Me.BtnKey)
        Me.GrpProd.Controls.Add(Me.PictureBox5)
        Me.GrpProd.Controls.Add(Me.GrpUnidades)
        Me.GrpProd.Controls.Add(Me.GrpPrecios)
        Me.GrpProd.Controls.Add(Me.Label5)
        Me.GrpProd.Controls.Add(Me.CmbSubLinea)
        Me.GrpProd.Controls.Add(Me.Label4)
        Me.GrpProd.Controls.Add(Me.CmbLinea)
        Me.GrpProd.Controls.Add(Me.Label3)
        Me.GrpProd.Controls.Add(Me.CmbMarca)
        Me.GrpProd.Controls.Add(Me.TxtNumParte)
        Me.GrpProd.Controls.Add(Me.GrpCosto)
        Me.GrpProd.Controls.Add(Me.ChkEstado)
        Me.GrpProd.Controls.Add(Me.lblCosto)
        Me.GrpProd.Controls.Add(Me.TxtDescripcion)
        Me.GrpProd.Controls.Add(Me.Label11)
        Me.GrpProd.Controls.Add(Me.TxtNombre)
        Me.GrpProd.Controls.Add(Me.LblNombre)
        Me.GrpProd.Controls.Add(Me.LblClave)
        Me.GrpProd.Controls.Add(Me.TxtClave)
        Me.GrpProd.Location = New System.Drawing.Point(6, 1)
        Me.GrpProd.MinimumSize = New System.Drawing.Size(399, 863)
        Me.GrpProd.Name = "GrpProd"
        Me.GrpProd.Size = New System.Drawing.Size(399, 863)
        Me.GrpProd.TabIndex = 1
        Me.GrpProd.TabStop = False
        Me.GrpProd.Text = "Producto"
        '
        'TxtCompany
        '
        Me.TxtCompany.Anchor = CType(((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.TxtCompany.Enabled = False
        Me.TxtCompany.Location = New System.Drawing.Point(82, 42)
        Me.TxtCompany.Name = "TxtCompany"
        Me.TxtCompany.ReadOnly = True
        Me.TxtCompany.Size = New System.Drawing.Size(309, 21)
        Me.TxtCompany.TabIndex = 104
        '
        'Label18
        '
        Me.Label18.Location = New System.Drawing.Point(8, 45)
        Me.Label18.Name = "Label18"
        Me.Label18.Size = New System.Drawing.Size(68, 16)
        Me.Label18.TabIndex = 103
        Me.Label18.Text = "Compañia"
        '
        'TxtNota
        '
        Me.TxtNota.Location = New System.Drawing.Point(80, 282)
        Me.TxtNota.Name = "TxtNota"
        Me.TxtNota.Size = New System.Drawing.Size(309, 21)
        Me.TxtNota.TabIndex = 102
        '
        'Label16
        '
        Me.Label16.Location = New System.Drawing.Point(8, 286)
        Me.Label16.Name = "Label16"
        Me.Label16.Size = New System.Drawing.Size(96, 16)
        Me.Label16.TabIndex = 101
        Me.Label16.Text = "Observación"
        '
        'PictureBox4
        '
        Me.PictureBox4.BackColor = System.Drawing.Color.LightSteelBlue
        Me.PictureBox4.Image = CType(resources.GetObject("PictureBox4.Image"), System.Drawing.Image)
        Me.PictureBox4.Location = New System.Drawing.Point(54, 226)
        Me.PictureBox4.Name = "PictureBox4"
        Me.PictureBox4.Size = New System.Drawing.Size(16, 16)
        Me.PictureBox4.TabIndex = 42
        Me.PictureBox4.TabStop = False
        Me.PictureBox4.Visible = False
        '
        'PictureBox1
        '
        Me.PictureBox1.Image = CType(resources.GetObject("PictureBox1.Image"), System.Drawing.Image)
        Me.PictureBox1.Location = New System.Drawing.Point(54, 163)
        Me.PictureBox1.Name = "PictureBox1"
        Me.PictureBox1.Size = New System.Drawing.Size(16, 16)
        Me.PictureBox1.TabIndex = 40
        Me.PictureBox1.TabStop = False
        Me.PictureBox1.Visible = False
        '
        'BtnKey
        '
        Me.BtnKey.Image = CType(resources.GetObject("BtnKey.Image"), System.Drawing.Image)
        Me.BtnKey.Location = New System.Drawing.Point(273, 159)
        Me.BtnKey.Name = "BtnKey"
        Me.BtnKey.Size = New System.Drawing.Size(32, 23)
        Me.BtnKey.TabIndex = 100
        Me.BtnKey.ToolTipText = "Generar clave automatica"
        Me.BtnKey.VisualStyle = Janus.Windows.UI.VisualStyle.Office2007
        '
        'PictureBox5
        '
        Me.PictureBox5.Image = CType(resources.GetObject("PictureBox5.Image"), System.Drawing.Image)
        Me.PictureBox5.Location = New System.Drawing.Point(54, 257)
        Me.PictureBox5.Name = "PictureBox5"
        Me.PictureBox5.Size = New System.Drawing.Size(16, 16)
        Me.PictureBox5.TabIndex = 72
        Me.PictureBox5.TabStop = False
        Me.PictureBox5.Visible = False
        '
        'GrpUnidades
        '
        Me.GrpUnidades.Anchor = CType(((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GrpUnidades.BackColor = System.Drawing.Color.Transparent
        Me.GrpUnidades.Controls.Add(Me.BtnAddUnidad)
        Me.GrpUnidades.Controls.Add(Me.PictureBox8)
        Me.GrpUnidades.Controls.Add(Me.BtnDelUnidad)
        Me.GrpUnidades.Controls.Add(Me.GridUnidades)
        Me.GrpUnidades.Location = New System.Drawing.Point(6, 387)
        Me.GrpUnidades.Name = "GrpUnidades"
        Me.GrpUnidades.Size = New System.Drawing.Size(383, 124)
        Me.GrpUnidades.TabIndex = 10
        Me.GrpUnidades.TabStop = False
        Me.GrpUnidades.Text = "Unidades de Venta del Producto"
        '
        'BtnAddUnidad
        '
        Me.BtnAddUnidad.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.BtnAddUnidad.Icon = CType(resources.GetObject("BtnAddUnidad.Icon"), System.Drawing.Icon)
        Me.BtnAddUnidad.Location = New System.Drawing.Point(283, 16)
        Me.BtnAddUnidad.Name = "BtnAddUnidad"
        Me.BtnAddUnidad.Size = New System.Drawing.Size(41, 20)
        Me.BtnAddUnidad.TabIndex = 101
        Me.BtnAddUnidad.ToolTipText = "Agregar unidad actual"
        Me.BtnAddUnidad.VisualStyle = Janus.Windows.UI.VisualStyle.Office2007
        '
        'PictureBox8
        '
        Me.PictureBox8.Image = CType(resources.GetObject("PictureBox8.Image"), System.Drawing.Image)
        Me.PictureBox8.Location = New System.Drawing.Point(261, 20)
        Me.PictureBox8.Name = "PictureBox8"
        Me.PictureBox8.Size = New System.Drawing.Size(16, 16)
        Me.PictureBox8.TabIndex = 74
        Me.PictureBox8.TabStop = False
        Me.PictureBox8.Visible = False
        '
        'BtnDelUnidad
        '
        Me.BtnDelUnidad.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.BtnDelUnidad.Icon = CType(resources.GetObject("BtnDelUnidad.Icon"), System.Drawing.Icon)
        Me.BtnDelUnidad.Location = New System.Drawing.Point(328, 16)
        Me.BtnDelUnidad.Name = "BtnDelUnidad"
        Me.BtnDelUnidad.Size = New System.Drawing.Size(41, 20)
        Me.BtnDelUnidad.TabIndex = 5
        Me.BtnDelUnidad.ToolTipText = "Eliminar unidad seleccionada"
        Me.BtnDelUnidad.VisualStyle = Janus.Windows.UI.VisualStyle.Office2007
        '
        'GridUnidades
        '
        Me.GridUnidades.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GridUnidades.ColumnAutoResize = True
        Me.GridUnidades.ColumnSetNavigation = Janus.Windows.GridEX.ColumnSetNavigation.ColumnSet
        Me.GridUnidades.Location = New System.Drawing.Point(12, 39)
        Me.GridUnidades.Name = "GridUnidades"
        Me.GridUnidades.RecordNavigator = True
        Me.GridUnidades.Size = New System.Drawing.Size(357, 79)
        Me.GridUnidades.TabIndex = 4
        Me.GridUnidades.VisualStyle = Janus.Windows.GridEX.VisualStyle.Office2007
        '
        'GrpPrecios
        '
        Me.GrpPrecios.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GrpPrecios.BackColor = System.Drawing.Color.Transparent
        Me.GrpPrecios.Controls.Add(Me.GridPrecios)
        Me.GrpPrecios.Controls.Add(Me.PictureBox9)
        Me.GrpPrecios.Location = New System.Drawing.Point(10, 512)
        Me.GrpPrecios.Name = "GrpPrecios"
        Me.GrpPrecios.Size = New System.Drawing.Size(379, 338)
        Me.GrpPrecios.TabIndex = 11
        Me.GrpPrecios.TabStop = False
        Me.GrpPrecios.Text = "Precios"
        '
        'GridPrecios
        '
        Me.GridPrecios.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GridPrecios.ColumnAutoResize = True
        Me.GridPrecios.ColumnSetNavigation = Janus.Windows.GridEX.ColumnSetNavigation.ColumnSet
        Me.GridPrecios.Location = New System.Drawing.Point(8, 16)
        Me.GridPrecios.Name = "GridPrecios"
        Me.GridPrecios.RecordNavigator = True
        Me.GridPrecios.Size = New System.Drawing.Size(362, 314)
        Me.GridPrecios.TabIndex = 60
        Me.GridPrecios.VisualStyle = Janus.Windows.GridEX.VisualStyle.Office2007
        '
        'PictureBox9
        '
        Me.PictureBox9.Image = CType(resources.GetObject("PictureBox9.Image"), System.Drawing.Image)
        Me.PictureBox9.Location = New System.Drawing.Point(120, 0)
        Me.PictureBox9.Name = "PictureBox9"
        Me.PictureBox9.Size = New System.Drawing.Size(16, 16)
        Me.PictureBox9.TabIndex = 74
        Me.PictureBox9.TabStop = False
        Me.PictureBox9.Visible = False
        '
        'Label5
        '
        Me.Label5.Location = New System.Drawing.Point(8, 129)
        Me.Label5.Name = "Label5"
        Me.Label5.Size = New System.Drawing.Size(68, 16)
        Me.Label5.TabIndex = 65
        Me.Label5.Text = "Sub Linea"
        '
        'CmbSubLinea
        '
        Me.CmbSubLinea.Location = New System.Drawing.Point(82, 126)
        Me.CmbSubLinea.Name = "CmbSubLinea"
        Me.CmbSubLinea.Size = New System.Drawing.Size(308, 24)
        Me.CmbSubLinea.TabIndex = 2
        '
        'Label4
        '
        Me.Label4.Location = New System.Drawing.Point(7, 102)
        Me.Label4.Name = "Label4"
        Me.Label4.Size = New System.Drawing.Size(69, 16)
        Me.Label4.TabIndex = 63
        Me.Label4.Text = "Linea"
        '
        'CmbLinea
        '
        Me.CmbLinea.Location = New System.Drawing.Point(82, 98)
        Me.CmbLinea.Name = "CmbLinea"
        Me.CmbLinea.Size = New System.Drawing.Size(309, 24)
        Me.CmbLinea.TabIndex = 1
        '
        'Label3
        '
        Me.Label3.Location = New System.Drawing.Point(7, 71)
        Me.Label3.Name = "Label3"
        Me.Label3.Size = New System.Drawing.Size(69, 16)
        Me.Label3.TabIndex = 61
        Me.Label3.Text = "Marca"
        '
        'CmbMarca
        '
        Me.CmbMarca.Location = New System.Drawing.Point(82, 68)
        Me.CmbMarca.Name = "CmbMarca"
        Me.CmbMarca.Size = New System.Drawing.Size(309, 24)
        Me.CmbMarca.TabIndex = 0
        '
        'TxtNumParte
        '
        Me.TxtNumParte.Location = New System.Drawing.Point(82, 191)
        Me.TxtNumParte.Name = "TxtNumParte"
        Me.TxtNumParte.Size = New System.Drawing.Size(184, 21)
        Me.TxtNumParte.TabIndex = 6
        '
        'GrpCosto
        '
        Me.GrpCosto.Anchor = CType(((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GrpCosto.BackColor = System.Drawing.Color.Transparent
        Me.GrpCosto.Controls.Add(Me.BtnCosto)
        Me.GrpCosto.Controls.Add(Me.cmbCosto)
        Me.GrpCosto.Controls.Add(Me.PictureBox16)
        Me.GrpCosto.Controls.Add(Me.TxtCost)
        Me.GrpCosto.Controls.Add(Me.PictureBox6)
        Me.GrpCosto.Controls.Add(Me.PictureBox7)
        Me.GrpCosto.Controls.Add(Me.Label1)
        Me.GrpCosto.Controls.Add(Me.LblMetodo)
        Me.GrpCosto.Location = New System.Drawing.Point(8, 303)
        Me.GrpCosto.Name = "GrpCosto"
        Me.GrpCosto.Size = New System.Drawing.Size(381, 79)
        Me.GrpCosto.TabIndex = 9
        Me.GrpCosto.TabStop = False
        Me.GrpCosto.Text = "Costo"
        '
        'BtnCosto
        '
        Me.BtnCosto.Icon = CType(resources.GetObject("BtnCosto.Icon"), System.Drawing.Icon)
        Me.BtnCosto.Location = New System.Drawing.Point(253, 46)
        Me.BtnCosto.Name = "BtnCosto"
        Me.BtnCosto.Size = New System.Drawing.Size(41, 20)
        Me.BtnCosto.TabIndex = 102
        Me.BtnCosto.ToolTipText = "Modificar Costo"
        Me.BtnCosto.VisualStyle = Janus.Windows.UI.VisualStyle.Office2007
        '
        'cmbCosto
        '
        Me.cmbCosto.ItemHeight = 16
        Me.cmbCosto.Location = New System.Drawing.Point(66, 14)
        Me.cmbCosto.Name = "cmbCosto"
        Me.cmbCosto.Size = New System.Drawing.Size(166, 24)
        Me.cmbCosto.TabIndex = 10
        '
        'PictureBox16
        '
        Me.PictureBox16.BackColor = System.Drawing.Color.LightSteelBlue
        Me.PictureBox16.Image = CType(resources.GetObject("PictureBox16.Image"), System.Drawing.Image)
        Me.PictureBox16.Location = New System.Drawing.Point(231, 47)
        Me.PictureBox16.Name = "PictureBox16"
        Me.PictureBox16.Size = New System.Drawing.Size(16, 16)
        Me.PictureBox16.TabIndex = 100
        Me.PictureBox16.TabStop = False
        Me.PictureBox16.Visible = False
        '
        'TxtCost
        '
        Me.TxtCost.Enabled = False
        Me.TxtCost.Location = New System.Drawing.Point(64, 46)
        Me.TxtCost.Name = "TxtCost"
        Me.TxtCost.ReadOnly = True
        Me.TxtCost.Size = New System.Drawing.Size(168, 21)
        Me.TxtCost.TabIndex = 11
        Me.TxtCost.Text = "0.00"
        Me.TxtCost.TextAlignment = Janus.Windows.GridEX.TextAlignment.Far
        Me.TxtCost.Value = 0
        Me.TxtCost.ValueType = Janus.Windows.GridEX.NumericEditValueType.[Double]
        '
        'PictureBox6
        '
        Me.PictureBox6.Image = CType(resources.GetObject("PictureBox6.Image"), System.Drawing.Image)
        Me.PictureBox6.Location = New System.Drawing.Point(48, 19)
        Me.PictureBox6.Name = "PictureBox6"
        Me.PictureBox6.Size = New System.Drawing.Size(16, 16)
        Me.PictureBox6.TabIndex = 73
        Me.PictureBox6.TabStop = False
        Me.PictureBox6.Visible = False
        '
        'PictureBox7
        '
        Me.PictureBox7.Image = CType(resources.GetObject("PictureBox7.Image"), System.Drawing.Image)
        Me.PictureBox7.Location = New System.Drawing.Point(47, 47)
        Me.PictureBox7.Name = "PictureBox7"
        Me.PictureBox7.Size = New System.Drawing.Size(16, 16)
        Me.PictureBox7.TabIndex = 73
        Me.PictureBox7.TabStop = False
        Me.PictureBox7.Visible = False
        '
        'Label1
        '
        Me.Label1.BackColor = System.Drawing.Color.LightSteelBlue
        Me.Label1.Location = New System.Drawing.Point(14, 49)
        Me.Label1.Name = "Label1"
        Me.Label1.Size = New System.Drawing.Size(44, 16)
        Me.Label1.TabIndex = 48
        Me.Label1.Text = "Costo"
        '
        'LblMetodo
        '
        Me.LblMetodo.BackColor = System.Drawing.Color.LightSteelBlue
        Me.LblMetodo.Location = New System.Drawing.Point(14, 19)
        Me.LblMetodo.Name = "LblMetodo"
        Me.LblMetodo.Size = New System.Drawing.Size(48, 16)
        Me.LblMetodo.TabIndex = 51
        Me.LblMetodo.Text = "Metodo"
        '
        'ChkEstado
        '
        Me.ChkEstado.Checked = True
        Me.ChkEstado.CheckState = System.Windows.Forms.CheckState.Checked
        Me.ChkEstado.Location = New System.Drawing.Point(325, 11)
        Me.ChkEstado.Name = "ChkEstado"
        Me.ChkEstado.Size = New System.Drawing.Size(66, 24)
        Me.ChkEstado.TabIndex = 52
        Me.ChkEstado.Text = "Activo"
        '
        'lblCosto
        '
        Me.lblCosto.Location = New System.Drawing.Point(8, 195)
        Me.lblCosto.Name = "lblCosto"
        Me.lblCosto.Size = New System.Drawing.Size(80, 16)
        Me.lblCosto.TabIndex = 47
        Me.lblCosto.Text = "Num. Parte"
        '
        'TxtDescripcion
        '
        Me.TxtDescripcion.Location = New System.Drawing.Point(81, 253)
        Me.TxtDescripcion.Name = "TxtDescripcion"
        Me.TxtDescripcion.Size = New System.Drawing.Size(308, 21)
        Me.TxtDescripcion.TabIndex = 8
        '
        'Label11
        '
        Me.Label11.Location = New System.Drawing.Point(8, 257)
        Me.Label11.Name = "Label11"
        Me.Label11.Size = New System.Drawing.Size(96, 16)
        Me.Label11.TabIndex = 34
        Me.Label11.Text = "Descripción"
        '
        'TxtNombre
        '
        Me.TxtNombre.Location = New System.Drawing.Point(82, 222)
        Me.TxtNombre.Name = "TxtNombre"
        Me.TxtNombre.Size = New System.Drawing.Size(256, 21)
        Me.TxtNombre.TabIndex = 7
        '
        'LblNombre
        '
        Me.LblNombre.Location = New System.Drawing.Point(8, 226)
        Me.LblNombre.Name = "LblNombre"
        Me.LblNombre.Size = New System.Drawing.Size(96, 16)
        Me.LblNombre.TabIndex = 3
        Me.LblNombre.Text = "Nombre"
        '
        'LblClave
        '
        Me.LblClave.Location = New System.Drawing.Point(8, 164)
        Me.LblClave.Name = "LblClave"
        Me.LblClave.Size = New System.Drawing.Size(68, 16)
        Me.LblClave.TabIndex = 1
        Me.LblClave.Text = "Clave"
        '
        'TxtClave
        '
        Me.TxtClave.Location = New System.Drawing.Point(82, 159)
        Me.TxtClave.Name = "TxtClave"
        Me.TxtClave.Size = New System.Drawing.Size(184, 21)
        Me.TxtClave.TabIndex = 5
        '
        'UiTabKits
        '
        Me.UiTabKits.Controls.Add(Me.GrpMultiproducto)
        Me.UiTabKits.Location = New System.Drawing.Point(1, 24)
        Me.UiTabKits.Name = "UiTabKits"
        Me.UiTabKits.Size = New System.Drawing.Size(779, 493)
        Me.UiTabKits.TabStop = True
        Me.UiTabKits.Text = "Kit o Multiempaque"
        '
        'GrpMultiproducto
        '
        Me.GrpMultiproducto.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GrpMultiproducto.BackColor = System.Drawing.Color.Transparent
        Me.GrpMultiproducto.Controls.Add(Me.BtnModProd)
        Me.GrpMultiproducto.Controls.Add(Me.BtnDelProd)
        Me.GrpMultiproducto.Controls.Add(Me.BtnAddProd)
        Me.GrpMultiproducto.Controls.Add(Me.GridMultiproducto)
        Me.GrpMultiproducto.Location = New System.Drawing.Point(13, 24)
        Me.GrpMultiproducto.Name = "GrpMultiproducto"
        Me.GrpMultiproducto.Size = New System.Drawing.Size(753, 459)
        Me.GrpMultiproducto.TabIndex = 7
        Me.GrpMultiproducto.TabStop = False
        Me.GrpMultiproducto.Text = "Detalle de Multiempaque"
        '
        'BtnModProd
        '
        Me.BtnModProd.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.BtnModProd.Image = CType(resources.GetObject("BtnModProd.Image"), System.Drawing.Image)
        Me.BtnModProd.Location = New System.Drawing.Point(659, 58)
        Me.BtnModProd.Name = "BtnModProd"
        Me.BtnModProd.Size = New System.Drawing.Size(86, 32)
        Me.BtnModProd.TabIndex = 7
        Me.BtnModProd.Text = "&Modificar"
        Me.BtnModProd.ToolTipText = "Modificar producto seleccionado"
        Me.BtnModProd.VisualStyle = Janus.Windows.UI.VisualStyle.Office2007
        '
        'BtnDelProd
        '
        Me.BtnDelProd.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.BtnDelProd.Image = CType(resources.GetObject("BtnDelProd.Image"), System.Drawing.Image)
        Me.BtnDelProd.Location = New System.Drawing.Point(659, 100)
        Me.BtnDelProd.Name = "BtnDelProd"
        Me.BtnDelProd.Size = New System.Drawing.Size(86, 32)
        Me.BtnDelProd.TabIndex = 8
        Me.BtnDelProd.Text = "&Eliminar"
        Me.BtnDelProd.ToolTipText = "Eliminar producto seleccionado"
        Me.BtnDelProd.VisualStyle = Janus.Windows.UI.VisualStyle.Office2007
        '
        'BtnAddProd
        '
        Me.BtnAddProd.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.BtnAddProd.Image = CType(resources.GetObject("BtnAddProd.Image"), System.Drawing.Image)
        Me.BtnAddProd.Location = New System.Drawing.Point(659, 16)
        Me.BtnAddProd.Name = "BtnAddProd"
        Me.BtnAddProd.Size = New System.Drawing.Size(86, 32)
        Me.BtnAddProd.TabIndex = 6
        Me.BtnAddProd.Text = "&Agregar "
        Me.BtnAddProd.ToolTipText = "Agregar producto"
        Me.BtnAddProd.VisualStyle = Janus.Windows.UI.VisualStyle.Office2007
        '
        'GridMultiproducto
        '
        Me.GridMultiproducto.AllowEdit = Janus.Windows.GridEX.InheritableBoolean.[False]
        Me.GridMultiproducto.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GridMultiproducto.ColumnAutoResize = True
        Me.GridMultiproducto.ColumnAutoSizeMode = Janus.Windows.GridEX.ColumnAutoSizeMode.DiaplayedCells
        Me.GridMultiproducto.ColumnSetNavigation = Janus.Windows.GridEX.ColumnSetNavigation.ColumnSet
        Me.GridMultiproducto.FilterMode = Janus.Windows.GridEX.FilterMode.Automatic
        Me.GridMultiproducto.Location = New System.Drawing.Point(8, 16)
        Me.GridMultiproducto.Name = "GridMultiproducto"
        Me.GridMultiproducto.RecordNavigator = True
        Me.GridMultiproducto.Size = New System.Drawing.Size(644, 435)
        Me.GridMultiproducto.TabIndex = 1
        Me.GridMultiproducto.VisualStyle = Janus.Windows.GridEX.VisualStyle.Office2007
        '
        'UiTabEquivalentes
        '
        Me.UiTabEquivalentes.Controls.Add(Me.GrpEquivalentes)
        Me.UiTabEquivalentes.Location = New System.Drawing.Point(1, 24)
        Me.UiTabEquivalentes.Name = "UiTabEquivalentes"
        Me.UiTabEquivalentes.Size = New System.Drawing.Size(779, 493)
        Me.UiTabEquivalentes.TabStop = True
        Me.UiTabEquivalentes.Text = "Equivalentes"
        '
        'GrpEquivalentes
        '
        Me.GrpEquivalentes.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GrpEquivalentes.BackColor = System.Drawing.Color.Transparent
        Me.GrpEquivalentes.Controls.Add(Me.BtnDelEquivalente)
        Me.GrpEquivalentes.Controls.Add(Me.BtnAddEquivalente)
        Me.GrpEquivalentes.Controls.Add(Me.GridEquivalentes)
        Me.GrpEquivalentes.Location = New System.Drawing.Point(16, 20)
        Me.GrpEquivalentes.Name = "GrpEquivalentes"
        Me.GrpEquivalentes.Size = New System.Drawing.Size(751, 453)
        Me.GrpEquivalentes.TabIndex = 0
        Me.GrpEquivalentes.TabStop = False
        Me.GrpEquivalentes.Text = "Productos Equivalentes o Sustitutos"
        '
        'BtnDelEquivalente
        '
        Me.BtnDelEquivalente.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.BtnDelEquivalente.Image = CType(resources.GetObject("BtnDelEquivalente.Image"), System.Drawing.Image)
        Me.BtnDelEquivalente.Location = New System.Drawing.Point(653, 64)
        Me.BtnDelEquivalente.Name = "BtnDelEquivalente"
        Me.BtnDelEquivalente.Size = New System.Drawing.Size(83, 32)
        Me.BtnDelEquivalente.TabIndex = 1
        Me.BtnDelEquivalente.Text = "&Eliminar"
        Me.BtnDelEquivalente.ToolTipText = "Eliminar producto seleccionado"
        Me.BtnDelEquivalente.VisualStyle = Janus.Windows.UI.VisualStyle.Office2007
        '
        'BtnAddEquivalente
        '
        Me.BtnAddEquivalente.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.BtnAddEquivalente.Image = CType(resources.GetObject("BtnAddEquivalente.Image"), System.Drawing.Image)
        Me.BtnAddEquivalente.Location = New System.Drawing.Point(653, 24)
        Me.BtnAddEquivalente.Name = "BtnAddEquivalente"
        Me.BtnAddEquivalente.Size = New System.Drawing.Size(85, 32)
        Me.BtnAddEquivalente.TabIndex = 0
        Me.BtnAddEquivalente.Text = "&Agregar "
        Me.BtnAddEquivalente.ToolTipText = "Agregar producto"
        Me.BtnAddEquivalente.VisualStyle = Janus.Windows.UI.VisualStyle.Office2007
        '
        'GridEquivalentes
        '
        Me.GridEquivalentes.AllowEdit = Janus.Windows.GridEX.InheritableBoolean.[False]
        Me.GridEquivalentes.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GridEquivalentes.ColumnAutoResize = True
        Me.GridEquivalentes.ColumnAutoSizeMode = Janus.Windows.GridEX.ColumnAutoSizeMode.DiaplayedCells
        Me.GridEquivalentes.ColumnSetNavigation = Janus.Windows.GridEX.ColumnSetNavigation.ColumnSet
        Me.GridEquivalentes.FilterMode = Janus.Windows.GridEX.FilterMode.Automatic
        Me.GridEquivalentes.Location = New System.Drawing.Point(16, 24)
        Me.GridEquivalentes.Name = "GridEquivalentes"
        Me.GridEquivalentes.RecordNavigator = True
        Me.GridEquivalentes.Size = New System.Drawing.Size(631, 413)
        Me.GridEquivalentes.TabIndex = 2
        Me.GridEquivalentes.VisualStyle = Janus.Windows.GridEX.VisualStyle.Office2007
        '
        'UiTabCosto
        '
        Me.UiTabCosto.Controls.Add(Me.GrpPrv)
        Me.UiTabCosto.Controls.Add(Me.GrpCostHist)
        Me.UiTabCosto.Location = New System.Drawing.Point(1, 24)
        Me.UiTabCosto.Name = "UiTabCosto"
        Me.UiTabCosto.Size = New System.Drawing.Size(779, 493)
        Me.UiTabCosto.TabStop = True
        Me.UiTabCosto.Text = "Historico"
        Me.UiTabCosto.Visible = False
        '
        'GrpPrv
        '
        Me.GrpPrv.Anchor = CType(((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GrpPrv.BackColor = System.Drawing.Color.Transparent
        Me.GrpPrv.Controls.Add(Me.GridPrv)
        Me.GrpPrv.Controls.Add(Me.BtnModificar)
        Me.GrpPrv.Controls.Add(Me.BtnAddPrv)
        Me.GrpPrv.Location = New System.Drawing.Point(6, 1)
        Me.GrpPrv.Name = "GrpPrv"
        Me.GrpPrv.Size = New System.Drawing.Size(769, 243)
        Me.GrpPrv.TabIndex = 2
        Me.GrpPrv.TabStop = False
        Me.GrpPrv.Text = "Proveedores"
        '
        'GridPrv
        '
        Me.GridPrv.AllowEdit = Janus.Windows.GridEX.InheritableBoolean.[False]
        Me.GridPrv.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GridPrv.ColumnAutoResize = True
        Me.GridPrv.ColumnAutoSizeMode = Janus.Windows.GridEX.ColumnAutoSizeMode.DiaplayedCells
        Me.GridPrv.ColumnSetNavigation = Janus.Windows.GridEX.ColumnSetNavigation.ColumnSet
        Me.GridPrv.GroupByBoxVisible = False
        Me.GridPrv.Location = New System.Drawing.Point(8, 16)
        Me.GridPrv.Name = "GridPrv"
        Me.GridPrv.RecordNavigator = True
        Me.GridPrv.Size = New System.Drawing.Size(665, 219)
        Me.GridPrv.TabIndex = 1
        Me.GridPrv.VisualStyle = Janus.Windows.GridEX.VisualStyle.Office2007
        '
        'BtnModificar
        '
        Me.BtnModificar.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.BtnModificar.Image = CType(resources.GetObject("BtnModificar.Image"), System.Drawing.Image)
        Me.BtnModificar.Location = New System.Drawing.Point(679, 51)
        Me.BtnModificar.Name = "BtnModificar"
        Me.BtnModificar.Size = New System.Drawing.Size(83, 32)
        Me.BtnModificar.TabIndex = 5
        Me.BtnModificar.Text = "&Modificar"
        Me.BtnModificar.ToolTipText = "Modificar Descuento del Proveedor Seleccionado"
        Me.BtnModificar.VisualStyle = Janus.Windows.UI.VisualStyle.Office2007
        '
        'BtnAddPrv
        '
        Me.BtnAddPrv.Anchor = CType((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.BtnAddPrv.Image = CType(resources.GetObject("BtnAddPrv.Image"), System.Drawing.Image)
        Me.BtnAddPrv.Location = New System.Drawing.Point(679, 13)
        Me.BtnAddPrv.Name = "BtnAddPrv"
        Me.BtnAddPrv.Size = New System.Drawing.Size(83, 32)
        Me.BtnAddPrv.TabIndex = 3
        Me.BtnAddPrv.Text = "&Agregar "
        Me.BtnAddPrv.ToolTipText = "Agregar proveedor"
        Me.BtnAddPrv.VisualStyle = Janus.Windows.UI.VisualStyle.Office2007
        '
        'GrpCostHist
        '
        Me.GrpCostHist.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GrpCostHist.BackColor = System.Drawing.Color.Transparent
        Me.GrpCostHist.Controls.Add(Me.GridCostHist)
        Me.GrpCostHist.Location = New System.Drawing.Point(7, 252)
        Me.GrpCostHist.Name = "GrpCostHist"
        Me.GrpCostHist.Size = New System.Drawing.Size(768, 231)
        Me.GrpCostHist.TabIndex = 1
        Me.GrpCostHist.TabStop = False
        Me.GrpCostHist.Text = "Historico de Costos"
        '
        'GridCostHist
        '
        Me.GridCostHist.AllowEdit = Janus.Windows.GridEX.InheritableBoolean.[False]
        Me.GridCostHist.Anchor = CType((((System.Windows.Forms.AnchorStyles.Top Or System.Windows.Forms.AnchorStyles.Bottom) _
                    Or System.Windows.Forms.AnchorStyles.Left) _
                    Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.GridCostHist.ColumnAutoResize = True
        Me.GridCostHist.ColumnAutoSizeMode = Janus.Windows.GridEX.ColumnAutoSizeMode.DiaplayedCells
        Me.GridCostHist.ColumnSetNavigation = Janus.Windows.GridEX.ColumnSetNavigation.ColumnSet
        Me.GridCostHist.GroupByBoxVisible = False
        Me.GridCostHist.Location = New System.Drawing.Point(8, 16)
        Me.GridCostHist.Name = "GridCostHist"
        Me.GridCostHist.RecordNavigator = True
        Me.GridCostHist.Size = New System.Drawing.Size(752, 207)
        Me.GridCostHist.TabIndex = 1
        Me.GridCostHist.VisualStyle = Janus.Windows.GridEX.VisualStyle.Office2007
        '
        'BtnReemplazo
        '
        Me.BtnReemplazo.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.BtnReemplazo.Enabled = False
        Me.BtnReemplazo.Icon = CType(resources.GetObject("BtnReemplazo.Icon"), System.Drawing.Icon)
        Me.BtnReemplazo.Location = New System.Drawing.Point(425, 525)
        Me.BtnReemplazo.Name = "BtnReemplazo"
        Me.BtnReemplazo.Size = New System.Drawing.Size(128, 32)
        Me.BtnReemplazo.TabIndex = 95
        Me.BtnReemplazo.Text = "&Remplazo Clave"
        Me.BtnReemplazo.ToolTipText = "Sustituir Clave de Producto"
        Me.BtnReemplazo.Visible = False
        Me.BtnReemplazo.VisualStyle = Janus.Windows.UI.VisualStyle.Office2007
        '
        'BtnGuardar
        '
        Me.BtnGuardar.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.BtnGuardar.Image = CType(resources.GetObject("BtnGuardar.Image"), System.Drawing.Image)
        Me.BtnGuardar.Location = New System.Drawing.Point(559, 525)
        Me.BtnGuardar.Name = "BtnGuardar"
        Me.BtnGuardar.Size = New System.Drawing.Size(108, 32)
        Me.BtnGuardar.TabIndex = 1
        Me.BtnGuardar.Text = "&Aceptar"
        Me.BtnGuardar.ToolTipText = "Guardar cambios"
        Me.BtnGuardar.VisualStyle = Janus.Windows.UI.VisualStyle.Office2007
        '
        'BtnCancelar
        '
        Me.BtnCancelar.Anchor = CType((System.Windows.Forms.AnchorStyles.Bottom Or System.Windows.Forms.AnchorStyles.Right), System.Windows.Forms.AnchorStyles)
        Me.BtnCancelar.Image = CType(resources.GetObject("BtnCancelar.Image"), System.Drawing.Image)
        Me.BtnCancelar.Location = New System.Drawing.Point(673, 525)
        Me.BtnCancelar.Name = "BtnCancelar"
        Me.BtnCancelar.Size = New System.Drawing.Size(108, 32)
        Me.BtnCancelar.TabIndex = 2
        Me.BtnCancelar.Text = "&Cancelar"
        Me.BtnCancelar.ToolTipText = "Cancelar y cerrar ventana"
        Me.BtnCancelar.VisualStyle = Janus.Windows.UI.VisualStyle.Office2007
        '
        'FrmProducto
        '
        Me.AutoScaleBaseSize = New System.Drawing.Size(6, 14)
        Me.AutoScroll = True
        Me.BackColor = System.Drawing.Color.LightSteelBlue
        Me.ClientSize = New System.Drawing.Size(784, 562)
        Me.Controls.Add(Me.BtnReemplazo)
        Me.Controls.Add(Me.BtnGuardar)
        Me.Controls.Add(Me.BtnCancelar)
        Me.Controls.Add(Me.UiTab1)
        Me.Font = New System.Drawing.Font("Century Gothic", 8.25!)
        Me.Icon = CType(resources.GetObject("$this.Icon"), System.Drawing.Icon)
        Me.MinimumSize = New System.Drawing.Size(800, 593)
        Me.Name = "FrmProducto"
        Me.Text = "Productos"
        CType(Me.UiTab1, System.ComponentModel.ISupportInitialize).EndInit()
        Me.UiTab1.ResumeLayout(False)
        Me.UiTabProducto.ResumeLayout(False)
        Me.Panel1.ResumeLayout(False)
        Me.GroupBox6.ResumeLayout(False)
        CType(Me.PicProducto, System.ComponentModel.ISupportInitialize).EndInit()
        Me.GroupBox5.ResumeLayout(False)
        Me.GroupBox5.PerformLayout()
        CType(Me.PictureBox11, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.PictureBox3, System.ComponentModel.ISupportInitialize).EndInit()
        Me.GroupBox4.ResumeLayout(False)
        Me.GroupBox4.PerformLayout()
        CType(Me.PictureBox14, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.PictureBox13, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.PictureBox12, System.ComponentModel.ISupportInitialize).EndInit()
        Me.GrpImpuestos.ResumeLayout(False)
        CType(Me.GridImpuestos, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.NumDec, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.PictureBox2, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.PictureBox15, System.ComponentModel.ISupportInitialize).EndInit()
        Me.GrpProd.ResumeLayout(False)
        Me.GrpProd.PerformLayout()
        CType(Me.PictureBox4, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.PictureBox1, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.PictureBox5, System.ComponentModel.ISupportInitialize).EndInit()
        Me.GrpUnidades.ResumeLayout(False)
        CType(Me.PictureBox8, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.GridUnidades, System.ComponentModel.ISupportInitialize).EndInit()
        Me.GrpPrecios.ResumeLayout(False)
        CType(Me.GridPrecios, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.PictureBox9, System.ComponentModel.ISupportInitialize).EndInit()
        Me.GrpCosto.ResumeLayout(False)
        Me.GrpCosto.PerformLayout()
        CType(Me.PictureBox16, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.PictureBox6, System.ComponentModel.ISupportInitialize).EndInit()
        CType(Me.PictureBox7, System.ComponentModel.ISupportInitialize).EndInit()
        Me.UiTabKits.ResumeLayout(False)
        Me.GrpMultiproducto.ResumeLayout(False)
        CType(Me.GridMultiproducto, System.ComponentModel.ISupportInitialize).EndInit()
        Me.UiTabEquivalentes.ResumeLayout(False)
        Me.GrpEquivalentes.ResumeLayout(False)
        CType(Me.GridEquivalentes, System.ComponentModel.ISupportInitialize).EndInit()
        Me.UiTabCosto.ResumeLayout(False)
        Me.GrpPrv.ResumeLayout(False)
        CType(Me.GridPrv, System.ComponentModel.ISupportInitialize).EndInit()
        Me.GrpCostHist.ResumeLayout(False)
        CType(Me.GridCostHist, System.ComponentModel.ISupportInitialize).EndInit()
        Me.ResumeLayout(False)

    End Sub

#End Region

#Region "Variables Publicas"

    '  Public IncluyeIva As Boolean = False
    Public bIngreso As Boolean = False
    Public TImpuesto As Integer = 1
    Public Padre As String
    Public PROClave As String
    Public Clave As String
    Public NumParte As String
    Public Descripcion As String
    Public Nombre As String
    Public Marca, Linea, Sublinea As Integer
    Public Estado As Integer
    Public Tipo As Integer = 1
    Public TOrigen As Integer = 1
    Public TCosto As Integer = 1
    Public TRotacion As Integer = 1
    Public Costo As Double
    'Public flag As String = "Second"
    Public url_imagen As String = ""
    Public Seguimiento As Integer = 1
    Public DiasGarantia As Integer
    Public Minimo As Double
    Public Reorden As Double
    Public Maximo As Double
    Public NumDecimales As Integer
    Public CMIClave As String = ""
    Public Nota As String = ""

#End Region

#Region "Variables Privadas"

    Private tmpCosto As Double

    Private RegistroGuardado As Boolean = False

    Private Enum Ejecutar
        Insert = 1
        Update = 0
    End Enum

    Public ActualizaCosto As Boolean = False

    Public ActualizaNeto As Boolean = False

    Private ActualizaUnidad As Boolean = False

    Private dtImpuesto, dtImpuestoProd, dtUnidades, dtPrecios As DataTable
    Private dtMultiproducto As DataTable
    Private dtEquivalentes As DataTable

    Private SourceToImage As Bitmap

    Private alerta(14) As PictureBox
    Private reloj As parpadea
    Private guardado As Boolean = False

    Private sMLTSelected As String
    Private sNombre As String

    Private sIMPSelected As String
    Private sImp As String

    Private sUnidad As String
    Private sUnidadNombre As String

    Private sEquivalente As String
    Private sProductoEquivalente As String
    Private lineaCargada As Boolean = False

    Private bCostoChanged As Boolean = False

    Private sPrvSelected As String = ""
    Private sClavePrv As String = ""
    Private sRazonSocialPrv As String = ""
    Private dDescuentoPrv As Double = 0
    Private iEstado As Integer

    Private EditaCosto As Integer = 1

    Private PicLoad As Boolean = False
    Private Imagenes(0) As Foto

#End Region

#Region "Producto General"



    'Public Sub AddEquivalentes(ByVal sMESClave As String, ByVal sClave As String, ByVal iEstado As Integer, ByVal sEstado As String)

    '    Dim foundRows() As Data.DataRow
    '    foundRows = dtMesas.Select("MESClave Like '" & sMESClave & "' and Baja = 0")

    '    If foundRows.Length = 0 Then

    '        foundRows = dtMesas.Select("Clave = '" & Trim(sClave) & "' and Baja = 0")
    '        If foundRows.Length = 0 Then

    '            Dim row1 As DataRow
    '            row1 = dtMesas.NewRow()
    '            'declara el nombre de la fila

    '            row1.Item("MESClave") = sMESClave
    '            row1.Item("Clave") = sClave
    '            row1.Item("Estado") = sEstado
    '            row1.Item("iEstado") = iEstado
    '            row1.Item("Update") = 1
    '            row1.Item("Baja") = 0

    '            dtMesas.Rows.Add(row1)
    '            'agrega la fila completo a la tabla

    '        Else
    '            Beep()
    '            MessageBox.Show("¡La clave de Mesa que intenta agregar ya existe para el Piso actual!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
    '        End If

    '    Else
    '        Dim foundRows2() As Data.DataRow

    '        foundRows2 = dtMesas.Select("Clave = '" & Trim(sClave) & "' and Baja = 0")
    '        If foundRows2.Length = 0 Then

    '            foundRows(0)("Clave") = sClave
    '            foundRows(0)("Estado") = sEstado
    '            foundRows(0)("iEstado") = iEstado
    '            foundRows(0)("update") = 1
    '        Else
    '            Beep()
    '            MessageBox.Show("¡La clave de Mesa que intenta agregar ya existe para el Piso actual!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
    '        End If
    '    End If
    'End Sub


    Public Function RecuperaImpuesto(ByVal iTipo As Integer) As Double
        Dim FactorImpuesto As Double = 1

        If Not dtImpuesto Is Nothing AndAlso dtImpuesto.Rows.Count > 0 Then
            Dim foundRows() As DataRow
            foundRows = dtImpuesto.Select("Marca=True and TImpuesto=" & CStr(iTipo))

            If foundRows.GetLength(0) > 0 Then

                Dim i As Integer
                Dim PrecioImp As Double = 100
                Dim ImpImporte As Double = 0
                For i = 0 To foundRows.GetUpperBound(0)

                    If foundRows(i)("SobreImp") = 1 Then
                        If foundRows(i)("TAplicacion") = 1 Then
                            ImpImporte = PrecioImp * foundRows(i)("Valor")
                        Else
                            ImpImporte = foundRows(i)("Valor")
                        End If
                    Else
                        If foundRows(i)("TAplicacion") = 1 Then
                            ImpImporte = 100 * foundRows(i)("Valor")
                        Else
                            ImpImporte = foundRows(i)("Valor")
                        End If
                    End If
                    PrecioImp = PrecioImp + ImpImporte
                Next

                FactorImpuesto = (1 + ((PrecioImp - 100) / 100))
            End If
        End If

        Return FactorImpuesto

    End Function

    Private Sub actualizaPrecios(ByVal Ejecutar As Ejecutar)
        Dim i As Integer

        For i = 0 To dtPrecios.Rows.Count - 1

            Select Case Ejecutar
                Case Ejecutar.Insert
                    If dtPrecios.Rows(i)("Factor") >= 0 Then
                        ModPOS.Ejecuta("sp_inserta_precio", _
                                        "@PREClave", dtPrecios.Rows(i)("PREClave"), _
                                        "@PROClave", PROClave, _
                                        "@Utilidad", Math.Abs(dtPrecios.Rows(i)("Factor") / 100), _
                                        "@Descuento", 0, _
                                        "@Puntos", 0, _
                                        "@General", dtPrecios.Rows(i)("Neto"), _
                                        "@Frontera", dtPrecios.Rows(i)("Frontera"), _
                                        "@Usuario", ModPOS.UsuarioActual)
                    Else
                        ModPOS.Ejecuta("sp_inserta_precio", _
                                        "@PREClave", dtPrecios.Rows(i)("PREClave"), _
                                        "@PROClave", PROClave, _
                                        "@Utilidad", Math.Abs(dtPrecios.Rows(i)("Fbase") / 100), _
                                        "@Descuento", 0, _
                                        "@Puntos", 0, _
                                        "@General", dtPrecios.Rows(i)("Neto"), _
                                        "@Frontera", dtPrecios.Rows(i)("Frontera"), _
                                        "@Usuario", ModPOS.UsuarioActual)
                    End If
                Case Ejecutar.Update

                    'If dtPrecios.Rows(i)("Fbase") <> dtPrecios.Rows(i)("Factor") OrElse _
                    'dtPrecios.Rows(i)("Costo") <> dtPrecios.Rows(i)("CostoRef") Then

                    ModPOS.Ejecuta("sp_modifica_precio_lista", _
                                   "@PREClave", dtPrecios.Rows(i)("PREClave"), _
                                   "@PROClave", PROClave, _
                                   "@Costo", dtPrecios.Rows(i)("CostoRef"), _
                                   "@Utilidad", Math.Abs(dtPrecios.Rows(i)("Factor") / 100), _
                                   "@Precio", CDbl(dtPrecios.Rows(i)("Precio")), _
                                   "@General", dtPrecios.Rows(i)("Neto"), _
                                   "@Frontera", dtPrecios.Rows(i)("Frontera"), _
                                   "@Usuario", ModPOS.UsuarioActual)
                    '  End If

            End Select

        Next

        'dtPrecios = ModPOS.Recupera_Tabla("sp_recupera_preciosprod", "@PROClave", PROClave)
        'GridPrecios.DataSource = dtPrecios
        'GridPrecios.RetrieveStructure(True)
        'GridPrecios.GroupByBoxVisible = False
        'GridPrecios.CurrentTable.Columns(1).Selectable = False
        'GridPrecios.CurrentTable.Columns(2).Selectable = False
        'GridPrecios.RootTable.Columns("Costo").Visible = False
        'GridPrecios.RootTable.Columns("CostoRef").Visible = False
        'GridPrecios.RootTable.Columns("Fbase").Visible = False
        'GridPrecios.RootTable.Columns("PREClave").Visible = False

    End Sub

    Private Function validaForm() As Boolean
        Dim i As Integer = 0

        If Me.TxtClave.Text = "" Then
            i += 1
            reloj = New parpadea(Me.alerta(0))
            reloj.Enabled = True
            reloj.Start()
        ElseIf Me.TxtClave.Text.Length > 20 Then
            Me.TxtClave.Text = Me.TxtClave.Text.Substring(0, 20)
        End If


        If Me.CmbTipo.SelectedValue Is Nothing Then
            i += 1
            reloj = New parpadea(Me.alerta(1))
            reloj.Enabled = True
            reloj.Start()
        End If


        If Me.CmbOrigen.SelectedValue Is Nothing Then
            i += 1
            reloj = New parpadea(Me.alerta(2))
            reloj.Enabled = True
            reloj.Start()
        End If

        If Me.TxtNombre.Text = "" Then
            i += 1
            reloj = New parpadea(Me.alerta(3))
            reloj.Enabled = True
            reloj.Start()
        ElseIf Me.TxtNombre.Text.Length > 50 Then
            Me.TxtNombre.Text = Me.TxtNombre.Text.Substring(0, 50)
        End If


        If Me.TxtDescripcion.Text = "" Then
            i += 1
            reloj = New parpadea(Me.alerta(4))
            reloj.Enabled = True
            reloj.Start()
        ElseIf Me.TxtDescripcion.Text.Length > 60 Then
            Me.TxtDescripcion.Text = Me.TxtDescripcion.Text.Substring(0, 60)
        End If

        If Me.cmbCosto.SelectedValue Is Nothing Then
            i += 1
            reloj = New parpadea(Me.alerta(5))
            reloj.Enabled = True
            reloj.Start()
        End If

        If TxtCost.Text = "" OrElse CDbl(TxtCost.Text) <= 0 Then
            i += 1
            reloj = New parpadea(Me.alerta(6))
            reloj.Enabled = True
            reloj.Start()
        End If

        If GridUnidades.RowCount = 0 Then
            i += 1
            reloj = New parpadea(Me.alerta(7))
            reloj.Enabled = True
            reloj.Start()
        End If

        If GridPrecios.RowCount = 0 Then
            i += 1
            reloj = New parpadea(Me.alerta(8))
            reloj.Enabled = True
            reloj.Start()
        End If

        If CmbTipo.SelectedIndex = 2 AndAlso GridMultiproducto.RowCount = 0 Then
            i += 1
            Beep()
            MessageBox.Show("¡No se han agregado productos al kit o multiproducto actual!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
        End If

        If Me.CmbSeguimiento.SelectedValue Is Nothing Then
            i += 1
            reloj = New parpadea(Me.alerta(9))
            reloj.Enabled = True
            reloj.Start()
        End If

        If CDbl(NumMinimo.Text) > CDbl(NumReorden.Text) Then
            i += 1
            reloj = New parpadea(Me.alerta(10))
            reloj.Enabled = True
            reloj.Start()
        End If

        If CDbl(NumReorden.Text) > CDbl(NumMaximo.Text) Then
            i += 1
            reloj = New parpadea(Me.alerta(11))
            reloj.Enabled = True
            reloj.Start()
        End If

        If Me.CmbTipoComision.SelectedValue Is Nothing Then
            i += 1
            reloj = New parpadea(Me.alerta(13))
            reloj.Enabled = True
            reloj.Start()
        End If

        If i > 0 Then
            Return False
        ElseIf Me.Padre = "Agregar" Then
            Dim Con As String = ModPOS.BDConexion

            If ModPOS.SiExite(Con, "sp_valida_PK", "@tabla", "Producto", "@clave", UCase(Trim(Me.TxtClave.Text)), "@COMClave", ModPOS.CompanyActual) > 0 Then
                Beep()
                MessageBox.Show("La Referencia que intenta agregar ya existe en el sistema", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error)
                reloj = New parpadea(Me.alerta(0))
                reloj.Enabled = True
                reloj.Start()
                Return False
            Else
                While i < Me.alerta.Length
                    Me.alerta(i).Visible = False
                    i += 1
                End While
                Return True
            End If
        Else
            While i < Me.alerta.Length
                Me.alerta(i).Visible = False
                i += 1
            End While
            Return True
        End If

    End Function

    Private Sub FrmProducto_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        'ModPOS.CambiarEstiloXP.CambiarEstilo(Me)

        Me.TxtCompany.Text = ModPOS.CompanyName

        alerta(0) = Me.PictureBox1
        alerta(1) = Me.PictureBox2
        alerta(2) = Me.PictureBox3
        alerta(3) = Me.PictureBox4
        alerta(4) = Me.PictureBox5
        alerta(5) = Me.PictureBox6
        alerta(6) = Me.PictureBox7
        alerta(7) = Me.PictureBox8
        alerta(8) = Me.PictureBox9
        alerta(9) = Me.PictureBox11
        alerta(10) = Me.PictureBox12
        alerta(11) = Me.PictureBox13
        alerta(12) = Me.PictureBox14
        alerta(13) = Me.PictureBox15
        alerta(14) = Me.PictureBox16

        With Me.CmbTipo
            .Conexion = ModPOS.BDConexion
            .ProcedimientoAlmacenado = "sp_filtra_valorref"
            .NombreParametro1 = "tabla"
            .Parametro1 = "Producto"
            .NombreParametro2 = "campo"
            .Parametro2 = "Tipo"
            .llenar()
        End With

        With Me.CmbOrigen
            .Conexion = ModPOS.BDConexion
            .ProcedimientoAlmacenado = "sp_filtra_valorref"
            .NombreParametro1 = "tabla"
            .Parametro1 = "Producto"
            .NombreParametro2 = "campo"
            .Parametro2 = "Origen"
            .llenar()
        End With

        With Me.cmbCosto
            .Conexion = ModPOS.BDConexion
            .ProcedimientoAlmacenado = "sp_filtra_valorref"
            .NombreParametro1 = "tabla"
            .Parametro1 = "Producto"
            .NombreParametro2 = "campo"
            .Parametro2 = "Costo"
            .llenar()
        End With

        With Me.CmbRotacion
            .Conexion = ModPOS.BDConexion
            .ProcedimientoAlmacenado = "sp_filtra_valorref"
            .NombreParametro1 = "tabla"
            .Parametro1 = "Producto"
            .NombreParametro2 = "campo"
            .Parametro2 = "Rotacion"
            .llenar()
        End With

        With Me.CmbMarca
            .Conexion = ModPOS.BDConexion
            .ProcedimientoAlmacenado = "sp_filtra_marca"
            .NombreParametro1 = "COMClave"
            .Parametro1 = ModPOS.CompanyActual
            .llenar()
        End With

        With Me.CmbSeguimiento
            .Conexion = ModPOS.BDConexion
            .ProcedimientoAlmacenado = "sp_filtra_valorref"
            .NombreParametro1 = "tabla"
            .Parametro1 = "Producto"
            .NombreParametro2 = "campo"
            .Parametro2 = "Seguimiento"
            .llenar()
        End With

        With Me.CmbLinea
            .Conexion = ModPOS.BDConexion
            .ProcedimientoAlmacenado = "sp_filtra_linea"
            .NombreParametro1 = "COMClave"
            .Parametro1 = ModPOS.CompanyActual
            .llenar()
            lineaCargada = True
        End With


        With Me.CmbTipoComision
            .Conexion = ModPOS.BDConexion
            .ProcedimientoAlmacenado = "sp_filtra_comision_producto"
            .llenar()
        End With

        If Not CmbLinea.SelectedValue Is Nothing AndAlso lineaCargada Then
            With Me.CmbSubLinea
                .Conexion = ModPOS.BDConexion
                .ProcedimientoAlmacenado = "sp_filtra_sublinea"
                .NombreParametro1 = "CLAClavePadre"
                .Parametro1 = CmbLinea.SelectedValue
                .llenar()
            End With
        End If

        TxtClave.Text = Clave
        TxtNumParte.Text = NumParte
        TxtNombre.Text = Nombre
        TxtDescripcion.Text = Descripcion
        TxtCost.Text = Costo
        tmpCosto = Costo
        TxtNota.Text = Nota

        TxtDiasGarantia.Text = CStr(DiasGarantia)
        NumMinimo.Text = Minimo
        NumReorden.Text = Reorden
        NumMaximo.Text = Maximo
        NumDec.Value = NumDecimales

        If Padre = "Agregar" Then

            PROClave = ModPOS.obtenerLlave

            dtUnidades = ModPOS.CrearTabla("ProductoUnidad", _
            "ID", "System.String", _
            "Unidad", "System.String", _
            "EAN", "System.String", _
            "Barras", "System.String", _
            "Factor", "System.Int32", _
            "Volumen", "System.Double")

            dtMultiproducto = ModPOS.CrearTabla("Multiproducto", _
            "ID", "System.String", _
            "PROClave", "System.String", _
            "Clave", "System.String", _
            "Nombre", "System.String", _
            "Unidad", "System.String", _
            "Cantidad", "System.Double", _
            "Estado", "System.String", _
            "iEstado", "System.Int32", _
            "Update", "System.Int32", _
            "Baja", "System.Int32", _
            "TProducto", "System.Int32")

            dtEquivalentes = ModPOS.CrearTabla("Equivalentes", _
            "ID", "System.String", _
            "Clave", "System.String", _
            "Nombre", "System.String", _
            "Descripción", "System.String", _
            "Update", "System.Int32", _
            "Baja", "System.Int32")

            dtPrecios = ModPOS.Recupera_Tabla("sp_recupera_precios", "@Costo", Costo, "@COMClave", ModPOS.CompanyActual)

        Else

            CmbTipo.SelectedValue = Tipo
            CmbOrigen.SelectedValue = TOrigen
            cmbCosto.SelectedValue = TCosto
            ChkEstado.Estado = Estado
            CmbRotacion.SelectedValue = TRotacion
            CmbMarca.SelectedValue = Marca
            CmbLinea.SelectedValue = Linea
            CmbSubLinea.SelectedValue = Sublinea
            CmbSeguimiento.SelectedValue = Seguimiento
            CmbTipoComision.SelectedValue = CMIClave

            BtnKey.Enabled = False
            BtnReemplazo.Visible = True
            BtnReemplazo.Enabled = True

            dtUnidades = ModPOS.Recupera_Tabla("sp_muestra_productounidad", "@PROClave", PROClave)

            dtMultiproducto = ModPOS.Recupera_Tabla("sp_muestra_multiproductos", "@ProductoPadre", PROClave)

            dtEquivalentes = ModPOS.Recupera_Tabla("sp_muestra_equivalentes", "@PROClave", PROClave)

            Dim dtUsuario As DataTable

            dtUsuario = Recupera_Tabla("sp_recupera_usuarioActual", "@Usuario", ModPOS.UsuarioActual)
            EditaCosto = IIf(dtUsuario.Rows(0)("ModCosto").GetType.FullName = "System.DBNull", 0, dtUsuario.Rows(0)("ModCosto"))
            dtUsuario.Dispose()

            If EditaCosto = 0 Then
                BtnCosto.Enabled = False
                GridPrecios.AllowEdit = Janus.Windows.GridEX.InheritableBoolean.False
            Else
                BtnCosto.Enabled = True
                GridPrecios.AllowEdit = Janus.Windows.GridEX.InheritableBoolean.True
            End If

            dtPrecios = ModPOS.Recupera_Tabla("sp_recupera_preciosprod", "@PROClave", PROClave, "@COMClave", ModPOS.CompanyActual)

        End If


        GridUnidades.DataSource = dtUnidades
        GridUnidades.RetrieveStructure(True)
        GridUnidades.GroupByBoxVisible = False
        GridUnidades.RootTable.Columns("ID").Visible = False
        GridUnidades.RootTable.Columns("EAN").Visible = False
        GridUnidades.CurrentTable.Columns(1).Selectable = False


        GridMultiproducto.DataSource = dtMultiproducto
        GridMultiproducto.RetrieveStructure(True)
        GridMultiproducto.GroupByBoxVisible = False
        GridMultiproducto.RootTable.Columns("ID").Visible = False
        GridMultiproducto.RootTable.Columns("PROClave").Visible = False
        GridMultiproducto.RootTable.Columns("iEstado").Visible = False
        GridMultiproducto.CurrentTable.Columns(1).Selectable = False
        GridMultiproducto.RootTable.Columns("Update").Visible = False
        GridMultiproducto.RootTable.Columns("Baja").Visible = False

        Dim fc As Janus.Windows.GridEX.GridEXFormatCondition
        fc = New Janus.Windows.GridEX.GridEXFormatCondition(GridMultiproducto.RootTable.Columns("Baja"), Janus.Windows.GridEX.ConditionOperator.Equal, 1)

        fc.FormatStyle.FontStrikeout = Janus.Windows.GridEX.TriState.True
        fc.FormatStyle.ForeColor = System.Drawing.SystemColors.GrayText
        GridMultiproducto.RootTable.FormatConditions.Add(fc)

        GridEquivalentes.DataSource = dtEquivalentes
        GridEquivalentes.RetrieveStructure(True)
        GridEquivalentes.GroupByBoxVisible = False
        GridEquivalentes.RootTable.Columns("ID").Visible = False
        GridEquivalentes.RootTable.Columns("Update").Visible = False
        GridEquivalentes.RootTable.Columns("Baja").Visible = False

        Dim fc1 As Janus.Windows.GridEX.GridEXFormatCondition
        fc1 = New Janus.Windows.GridEX.GridEXFormatCondition(GridEquivalentes.RootTable.Columns("Baja"), Janus.Windows.GridEX.ConditionOperator.Equal, 1)

        fc1.FormatStyle.FontStrikeout = Janus.Windows.GridEX.TriState.True
        fc1.FormatStyle.ForeColor = System.Drawing.SystemColors.GrayText
        GridEquivalentes.RootTable.FormatConditions.Add(fc1)

        GridPrecios.DataSource = dtPrecios
        GridPrecios.RetrieveStructure(True)
        GridPrecios.GroupByBoxVisible = False
        GridPrecios.CurrentTable.Columns(1).Selectable = False
        GridPrecios.CurrentTable.Columns(2).Selectable = False
        GridPrecios.CurrentTable.Columns("Precio").Selectable = False
        GridPrecios.CurrentTable.Columns("Frontera").Selectable = False
        GridPrecios.RootTable.Columns("Costo").Visible = False
        GridPrecios.RootTable.Columns("CostoRef").Visible = False
        GridPrecios.RootTable.Columns("Fbase").Visible = False
        GridPrecios.RootTable.Columns("PREClave").Visible = False

        Me.RecuperaImagenProducto()

        dtImpuesto = ModPOS.Recupera_Tabla("sp_filtra_impuestos")
        If Not dtImpuesto Is Nothing Then
            GridImpuestos.DataSource = dtImpuesto
            GridImpuestos.RetrieveStructure(True)
            GridImpuestos.GroupByBoxVisible = False
            GridImpuestos.RootTable.Columns("IMPClave").Visible = False
            GridImpuestos.RootTable.Columns("TAplicacion").Visible = False
            GridImpuestos.RootTable.Columns("SobreImp").Visible = False
            GridImpuestos.RootTable.Columns("Valor").Visible = False
            GridImpuestos.RootTable.Columns("TImpuesto").Visible = False
            GridImpuestos.CurrentTable.Columns("Nombre").Selectable = False
            GridImpuestos.CurrentTable.Columns("Tipo").Selectable = False


            ChkMarcaTodos.Enabled = True

            If Padre = "Agregar" Then
                dtImpuestoProd = ModPOS.Recupera_Tabla("sp_filtra_impuestos_def")
            Else
                dtImpuestoProd = ModPOS.Recupera_Tabla("sp_filtra_impuestos_prod", "@Producto", PROClave)
            End If

            If Not dtImpuestoProd Is Nothing Then
                Dim y, x As Integer
                For y = 0 To dtImpuesto.Rows.Count - 1
                    For x = 0 To dtImpuestoProd.Rows.Count - 1
                        If dtImpuesto.Rows(y)("IMPClave") = dtImpuestoProd.Rows(x)("IMPClave") Then
                            dtImpuesto.Rows(y)("Marca") = True
                            Exit For
                        End If
                    Next
                Next
            End If
        End If
    End Sub

    Private Sub Reinicializa()
        CmbMarca.Focus()

        Me.AutoScrollPosition = New Point(0, 0)
        tmpCosto = 0
        Clave = ""
        Nombre = ""
        Descripcion = ""
        Costo = 0
        NumParte = ""
        DiasGarantia = 0
        Estado = 1
        Tipo = 1
        TOrigen = 1
        TCosto = 1
        TRotacion = 1
        Minimo = 0
        Reorden = 1
        Maximo = 2
        url_imagen = ""
        Seguimiento = 1
        NumDecimales = 0
        Nota = ""

        Nota = TxtNota.Text.ToUpper.Trim

        TxtClave.Text = Clave
        TxtNombre.Text = Nombre
        TxtDescripcion.Text = Descripcion
        TxtCost.Text = Costo
        CmbTipo.SelectedValue = Tipo
        CmbOrigen.SelectedValue = TOrigen
        cmbCosto.SelectedValue = TCosto
        ChkEstado.Estado = Estado
        CmbRotacion.SelectedValue = TRotacion
        CmbMarca.SelectedValue = Marca
        CmbLinea.SelectedValue = Linea
        CmbSubLinea.SelectedValue = Sublinea
        CmbSeguimiento.SelectedValue = Seguimiento
        TxtDiasGarantia.Text = CStr(DiasGarantia)
        NumMinimo.Text = Minimo
        NumReorden.Text = Reorden
        NumMaximo.Text = Maximo
        NumDec.Value = NumDecimales

        PROClave = ModPOS.obtenerLlave

        dtUnidades.Dispose()

        dtUnidades = ModPOS.CrearTabla("ProductoUnidad", _
        "ID", "System.String", _
        "Unidad", "System.String", _
        "EAN", "System.String", _
        "Barras", "System.String", _
        "Factor", "System.Int32")

        dtMultiproducto.Dispose()

        dtMultiproducto = ModPOS.CrearTabla("Multiproducto", _
      "ID", "System.String", _
      "PROClave", "System.String", _
      "Clave", "System.String", _
      "Nombre", "System.String", _
      "Descripción", "System.String", _
      "Cantidad", "System.Double", _
      "Estado", "System.String", _
      "iEstado", "System.Int32", _
      "Update", "System.Int32", _
      "Baja", "System.Int32")

        dtEquivalentes = ModPOS.CrearTabla("Equivalentes", _
            "ID", "System.String", _
            "Clave", "System.String", _
            "Nombre", "System.String", _
            "Descripción", "System.String", _
            "Update", "System.Int32", _
            "Baja", "System.Int32")

        dtPrecios.Dispose()
        dtPrecios = ModPOS.Recupera_Tabla("sp_recupera_precios", "@Costo", Costo, "@COMClave", ModPOS.CompanyActual)

        GridUnidades.DataSource = dtUnidades
        GridUnidades.RetrieveStructure(True)
        GridUnidades.GroupByBoxVisible = False
        GridUnidades.RootTable.Columns("ID").Visible = False
        GridUnidades.RootTable.Columns("EAN").Visible = False
        GridUnidades.CurrentTable.Columns(1).Selectable = False


        GridMultiproducto.DataSource = dtMultiproducto
        GridMultiproducto.RetrieveStructure(True)
        GridMultiproducto.GroupByBoxVisible = False
        GridMultiproducto.RootTable.Columns("ID").Visible = False
        GridMultiproducto.RootTable.Columns("PROClave").Visible = False
        GridMultiproducto.RootTable.Columns("iEstado").Visible = False
        GridMultiproducto.CurrentTable.Columns(1).Selectable = False
        GridMultiproducto.RootTable.Columns("Update").Visible = False
        GridMultiproducto.RootTable.Columns("Baja").Visible = False

        Dim fc As Janus.Windows.GridEX.GridEXFormatCondition
        fc = New Janus.Windows.GridEX.GridEXFormatCondition(GridMultiproducto.RootTable.Columns("Baja"), Janus.Windows.GridEX.ConditionOperator.Equal, 1)

        fc.FormatStyle.FontStrikeout = Janus.Windows.GridEX.TriState.True
        fc.FormatStyle.ForeColor = System.Drawing.SystemColors.GrayText
        GridMultiproducto.RootTable.FormatConditions.Add(fc)

        GridEquivalentes.DataSource = dtEquivalentes
        GridEquivalentes.RetrieveStructure(True)
        GridEquivalentes.GroupByBoxVisible = False
        GridEquivalentes.RootTable.Columns("ID").Visible = False
        GridEquivalentes.RootTable.Columns("Update").Visible = False
        GridEquivalentes.RootTable.Columns("Baja").Visible = False

        Dim fc1 As Janus.Windows.GridEX.GridEXFormatCondition
        fc1 = New Janus.Windows.GridEX.GridEXFormatCondition(GridEquivalentes.RootTable.Columns("Baja"), Janus.Windows.GridEX.ConditionOperator.Equal, 1)

        fc1.FormatStyle.FontStrikeout = Janus.Windows.GridEX.TriState.True
        fc1.FormatStyle.ForeColor = System.Drawing.SystemColors.GrayText
        GridEquivalentes.RootTable.FormatConditions.Add(fc1)



        GridPrecios.DataSource = dtPrecios

        GridPrecios.RetrieveStructure(True)
        GridPrecios.GroupByBoxVisible = False
        GridPrecios.CurrentTable.Columns(1).Selectable = False
        GridPrecios.CurrentTable.Columns(2).Selectable = False
        GridPrecios.CurrentTable.Columns("Precio").Selectable = False
        GridPrecios.CurrentTable.Columns("Frontera").Selectable = False
        GridPrecios.RootTable.Columns("Costo").Visible = False
        GridPrecios.RootTable.Columns("CostoRef").Visible = False
        GridPrecios.RootTable.Columns("Fbase").Visible = False
        GridPrecios.RootTable.Columns("PREClave").Visible = False


        If Not dtImpuestoProd Is Nothing Then
            Dim y, x As Integer
            Dim fila As String
            For y = 0 To dtImpuesto.Rows.Count - 1
                For x = 0 To dtImpuestoProd.Rows.Count - 1
                    fila = dtImpuesto.Rows(y)("IMPClave")
                    If fila = dtImpuestoProd.Rows(x)("IMPClave") Then
                        dtImpuesto.Rows(y)("Marca") = True
                    Else
                        dtImpuesto.Rows(y)("Marca") = False
                    End If
                Next
            Next
        End If


    End Sub

    Private Sub BtnGuardar_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnGuardar.Click
        If validaForm() Then
            Dim foundRows() As DataRow
            Dim z As Integer

            Select Case Me.Padre
                Case "Agregar"
                    Try

                        Clave = Me.TxtClave.Text.ToUpper.Trim
                        NumParte = TxtNumParte.Text.ToUpper.Trim
                        Nombre = Me.TxtNombre.Text.ToUpper.Trim
                        Descripcion = Me.TxtDescripcion.Text.ToUpper.Trim
                        Nota = TxtNota.Text.ToUpper.Trim
                        Tipo = Me.CmbTipo.SelectedValue
                        TCosto = Me.cmbCosto.SelectedValue
                        TOrigen = Me.CmbOrigen.SelectedValue
                        TRotacion = IIf(CmbRotacion.SelectedValue Is Nothing, 0, CmbRotacion.SelectedValue)
                        Marca = IIf(CmbMarca.SelectedValue Is Nothing, 0, CmbMarca.SelectedValue)
                        Linea = IIf(CmbLinea.SelectedValue Is Nothing, 0, CmbLinea.SelectedValue)
                        Sublinea = IIf(CmbSubLinea.SelectedValue Is Nothing, 0, CmbSubLinea.SelectedValue)
                        Seguimiento = CmbSeguimiento.SelectedValue
                        DiasGarantia = IIf(TxtDiasGarantia.Text = "", 0, Math.Abs(CInt(TxtDiasGarantia.Text)))
                        Minimo = IIf(NumMinimo.Text = "", 0, Math.Abs(CDbl(NumMinimo.Text)))
                        Reorden = IIf(NumReorden.Text = "", 0, Math.Abs(CDbl(NumReorden.Text)))
                        Maximo = IIf(NumMaximo.Text = "", 0, Math.Abs(CDbl(NumMaximo.Text)))
                        NumDecimales = NumDec.Value
                        CMIClave = CmbTipoComision.SelectedValue

                        ModPOS.Ejecuta("sp_inserta_producto", _
                        "@PROClave", PROClave, _
                        "@Clave", Clave, _
                        "@NumParte", NumParte, _
                        "@Nombre", Nombre, _
                        "@Descripcion", Descripcion, _
                        "@Tipo", Tipo, _
                        "@TOrigen", TOrigen, _
                        "@TCosto", TCosto, _
                        "@TRotacion", TRotacion, _
                        "@Seguimiento", Seguimiento, _
                        "@DiasGarantia", DiasGarantia, _
                        "@Minimo", Minimo, _
                        "@Maximo", Maximo, _
                        "@Reorden", Reorden, _
                        "@NumDecimales", NumDecimales, _
                        "@CMIClave", CMIClave, _
                        "@Nota", Nota, _
                        "@Usuario", ModPOS.UsuarioActual, _
                        "@COMClave", ModPOS.CompanyActual)

                        If Marca > 0 Then
                            ModPOS.Ejecuta("sp_inserta_clasprod", "@Tipo", 3, "@Class", Marca, "@Producto", PROClave, "@Usuario", ModPOS.UsuarioActual)
                        End If

                        If Linea > 0 Then
                            ModPOS.Ejecuta("sp_inserta_clasprod", "@Tipo", 4, "@Class", Linea, "@Producto", PROClave, "@Usuario", ModPOS.UsuarioActual)
                        End If

                        If Sublinea > 0 Then
                            ModPOS.Ejecuta("sp_inserta_clasprod", "@Tipo", 4, "@Class", Sublinea, "@Producto", PROClave, "@Usuario", ModPOS.UsuarioActual)
                        End If

                        'Impuesto

                        foundRows = dtImpuesto.Select("Marca=True")

                        If foundRows.GetLength(0) > 0 Then
                            Dim sIMPClave As String
                            For z = 0 To foundRows.GetUpperBound(0)
                                sIMPClave = foundRows(z)("IMPClave")
                                ModPOS.Ejecuta("sp_inserta_impprod", "@IMPClave", sIMPClave, "@Producto", PROClave, "@Usuario", ModPOS.UsuarioActual)
                            Next
                        End If

                        ModPOS.Ejecuta("sp_inserta_costo", "@PROClave", PROClave, "@Costo", Math.Abs(CDbl(TxtCost.Text)), "@Usuario", ModPOS.UsuarioActual)

                        'Precio
                        Me.actualizaPrecios(Ejecutar.Insert)

                        'Unidades
                        If dtUnidades.Rows.Count > 0 Then
                            Dim i As Integer
                            For i = 0 To dtUnidades.Rows.Count - 1
                                ModPOS.Ejecuta("sp_inserta_productounidad", _
                              "@UNDClave", dtUnidades.Rows(i)("ID"), _
                                                      "@PROClave", PROClave, _
                                                      "@GTIN", dtUnidades.Rows(i)("Barras"), _
                                                      "@Factor", dtUnidades.Rows(i)("Factor"), _
                                                      "@Volumen", dtUnidades.Rows(i)("Volumen"), _
                                                      "@Usuario", ModPOS.UsuarioActual)
                            Next
                        End If


                        'Si es un multiproducto

                        If Tipo = 3 Then
                            foundRows = dtMultiproducto.Select(" Update = 1 and Baja = 0 ")
                            If foundRows.Length <> 0 Then
                                'inserta metodos de pago
                                For z = 0 To foundRows.GetUpperBound(0)
                                    ModPOS.Ejecuta("sp_inserta_proddet", _
                                    "@MLTClave", foundRows(z)("ID"), _
                                    "@PROClavePadre", PROClave, _
                                    "@PROClave", foundRows(z)("PROClave"), _
                                    "@CantidadUnidades", foundRows(z)("Cantidad"), _
                                    "@Estado", foundRows(z)("iEstado"), _
                                    "@Usuario", ModPOS.UsuarioActual)
                                Next
                            End If
                        End If

                        'Equivalentes

                        foundRows = dtEquivalentes.Select(" Update = 1 and Baja = 0 ")

                        If foundRows.Length <> 0 Then
                            'inserta metodos de pago
                            For z = 0 To foundRows.GetUpperBound(0)
                                ModPOS.Ejecuta("sp_inserta_equivalente", _
                                "@PROClave", Me.PROClave, _
                                "@ProductoEquivalente", foundRows(z)("ID"), _
                                "@Usuario", ModPOS.UsuarioActual)
                            Next
                        End If


                        'Actualización 18 de Junio 2007 graba registro en existencia.

                        Dim fila As Integer

                        Dim dtalm, dtubc As DataTable


                        dtalm = ModPOS.Recupera_Tabla("sp_muestra_almacenes", "@COMClave", ModPOS.CompanyActual)
                        If Not dtalm Is Nothing AndAlso dtalm.Rows.Count > 0 Then
                            For fila = 0 To dtalm.Rows.Count - 1
                                If dtalm.Rows(fila)("ALMClave").GetType.Name <> "DBNull" Then
                                    dtubc = ModPOS.Recupera_Tabla("sp_ubc_inicial", "@ALMClave", dtalm.Rows(fila)("ALMClave"), "@PROClave", PROClave)
                                    If Not dtubc Is Nothing AndAlso dtubc.Rows.Count > 0 Then
                                        If dtubc.Rows(0)("UBCClave").GetType.Name <> "DBNull" Then
                                            ModPOS.Ejecuta("sp_ingreso_ubc", "@PROClave", PROClave, "@UBCClave", dtubc.Rows(0)("UBCClave"), "@Cantidad", 0, "@Usuario", ModPOS.UsuarioActual)
                                        End If
                                        dtubc.Dispose()
                                    End If
                                End If
                            Next
                            dtalm.Dispose()
                        End If

                        ModPOS.Ejecuta("sp_inserta_existencia", _
                       "@PROClave", Me.PROClave, _
                       "@Usuario", ModPOS.UsuarioActual)


                        If PicLoad = True Then
                            Dim i As Integer
                            For i = 0 To Imagenes.Length - 1
                                If Imagenes(i) IsNot Nothing Then
                                    If Imagenes(i).Estado = 1 Then
                                        ModPOS.Ejecuta("sp_inserta_imagen", "@PROClave", PROClave, "@IMGClave", Imagenes(i).IMGClave, "@Imagen", Imagenes(i).Foto, "@Usuario", ModPOS.UsuarioActual)
                                    End If
                                End If
                            Next
                        End If

                        Reinicializa()

                    Catch ex As Exception
                        ModPOS.Ejecuta("sp_deshacer_altaprod", "@PROClave", PROClave)
                    End Try

                Case "Modificar"

                    If Not ( _
                    Clave = Me.TxtClave.Text.Trim.ToUpper AndAlso _
                    NumParte = Me.TxtNumParte.Text.ToUpper.Trim AndAlso _
                    Nombre = Me.TxtNombre.Text.ToUpper.Trim AndAlso _
                    Descripcion = Me.TxtDescripcion.Text.ToUpper.Trim AndAlso _
                    Tipo = Me.CmbTipo.SelectedValue AndAlso _
                    TOrigen = Me.CmbOrigen.SelectedValue AndAlso _
                    TCosto = Me.cmbCosto.SelectedValue AndAlso _
                    TRotacion = IIf(CmbRotacion.SelectedValue Is Nothing, 0, CmbRotacion.SelectedValue) AndAlso _
                    Marca = IIf(CmbMarca.SelectedValue Is Nothing, 0, CmbMarca.SelectedValue) AndAlso _
                    Linea = IIf(CmbLinea.SelectedValue Is Nothing, 0, CmbLinea.SelectedValue) AndAlso _
                    Sublinea = IIf(CmbSubLinea.SelectedValue Is Nothing, 0, CmbSubLinea.SelectedValue) AndAlso _
                    Costo = Math.Abs(CDbl(TxtCost.Text)) AndAlso _
                    Seguimiento = CmbSeguimiento.SelectedValue AndAlso _
                    DiasGarantia = Math.Abs(CInt(TxtDiasGarantia.Text)) AndAlso _
                    Minimo = Math.Abs(CDbl(NumMinimo.Text)) AndAlso _
                    Reorden = Math.Abs(CDbl(NumReorden.Text)) AndAlso _
                    Maximo = Math.Abs(CDbl(NumMaximo.Text)) AndAlso _
                    NumDecimales = NumDec.Value AndAlso _
                    Estado = Me.ChkEstado.GetEstado AndAlso _
                    CmbTipoComision.SelectedValue = CMIClave AndAlso _
                    ActualizaCosto = False AndAlso _
                    Nota = TxtNota.Text.ToUpper.Trim AndAlso _
                    ActualizaNeto = False) Then

                        Clave = Me.TxtClave.Text.Trim.ToUpper
                        Nombre = Me.TxtNombre.Text.ToUpper.Trim
                        NumParte = Me.TxtNumParte.Text.ToUpper.Trim
                        Descripcion = Me.TxtDescripcion.Text.ToUpper.Trim
                        Tipo = Me.CmbTipo.SelectedValue
                        TOrigen = Me.CmbOrigen.SelectedValue
                        TCosto = Me.cmbCosto.SelectedValue
                        Estado = Me.ChkEstado.GetEstado
                        TRotacion = IIf(CmbRotacion.SelectedValue Is Nothing, 0, CmbRotacion.SelectedValue)
                        Seguimiento = CmbSeguimiento.SelectedValue
                        DiasGarantia = IIf(TxtDiasGarantia.Text = "", 0, Math.Abs(CInt(TxtDiasGarantia.Text)))
                        Minimo = IIf(NumMinimo.Text = "", 0, Math.Abs(CDbl(NumMinimo.Text)))
                        Reorden = IIf(NumReorden.Text = "", 0, Math.Abs(CDbl(NumReorden.Text)))
                        Maximo = IIf(NumMaximo.Text = "", 0, Math.Abs(CDbl(NumMaximo.Text)))
                        NumDecimales = NumDec.Value
                        CMIClave = CmbTipoComision.SelectedValue
                        Nota = TxtNota.Text.ToUpper.Trim
                        Dim aMarca, aLinea, aSublinea As Integer
                        aMarca = Marca
                        aLinea = Linea
                        aSublinea = Sublinea

                        Marca = IIf(CmbMarca.SelectedValue Is Nothing, 0, CmbMarca.SelectedValue)
                        Linea = IIf(CmbLinea.SelectedValue Is Nothing, 0, CmbLinea.SelectedValue)
                        Sublinea = IIf(CmbSubLinea.SelectedValue Is Nothing, 0, CmbSubLinea.SelectedValue)

                        ModPOS.Ejecuta("sp_modifica_producto", _
                        "@PROClave", PROClave, _
                        "@Clave", Clave, _
                        "@NumParte", NumParte, _
                        "@Nombre", Nombre, _
                        "@Descripcion", Descripcion, _
                        "@Tipo", Tipo, _
                        "@TOrigen", TOrigen, _
                        "@TCosto", TCosto, _
                        "@TRotacion", TRotacion, _
                        "@Estado", Estado, _
                        "@Seguimiento", Seguimiento, _
                        "@DiasGarantia", DiasGarantia, _
                        "@Minimo", Minimo, _
                        "@Maximo", Maximo, _
                        "@Reorden", Reorden, _
                        "@NumDecimales", NumDecimales, _
                        "@CMIClave", CMIClave, _
                        "@Nota", Nota, _
                        "@Usuario", ModPOS.UsuarioActual, _
                        "@COMClave", ModPOS.CompanyActual)

                        'Impuesto

                        ModPOS.Ejecuta("sp_elimina_impprod", "@Producto", PROClave)


                        foundRows = dtImpuesto.Select("Marca=True")

                        If foundRows.GetLength(0) > 0 Then
                            Dim sIMPClave As String
                            For z = 0 To foundRows.GetUpperBound(0)
                                sIMPClave = foundRows(z)("IMPClave")
                                ModPOS.Ejecuta("sp_inserta_impprod", "@IMPClave", sIMPClave, "@Producto", PROClave, "@Usuario", ModPOS.UsuarioActual)
                            Next
                        End If

                        If Costo <> Math.Abs(CDbl(TxtCost.Text)) Then
                            ModPOS.Ejecuta("sp_inserta_costo", "@PROClave", PROClave, "@Costo", Math.Abs(CDbl(TxtCost.Text)), "@Usuario", ModPOS.UsuarioActual)
                        End If

                        'Si no existia un registro en clasificacion.
                        If aMarca = 0 AndAlso Marca > 0 Then
                            ModPOS.Ejecuta("sp_inserta_clasprod", "@Tipo", 3, "@Class", Marca, "@Producto", PROClave, "@Usuario", ModPOS.UsuarioActual)
                        End If

                        If aLinea = 0 AndAlso Linea > 0 Then
                            ModPOS.Ejecuta("sp_inserta_clasprod", "@Tipo", 4, "@Class", Linea, "@Producto", PROClave, "@Usuario", ModPOS.UsuarioActual)
                        End If

                        If aSublinea = 0 AndAlso Sublinea > 0 Then
                            ModPOS.Ejecuta("sp_inserta_clasprod", "@Tipo", 4, "@Class", Sublinea, "@Producto", PROClave, "@Usuario", ModPOS.UsuarioActual)
                        End If

                        'Si existia un registro en clasificacion, se borra

                        If aMarca > 0 AndAlso Marca = 0 Then
                            ModPOS.Ejecuta("sp_elimina_clasprod", "@Tipo", 3, "@Class", Marca, "@Producto", PROClave)
                        End If

                        If aLinea > 0 AndAlso Linea = 0 Then
                            ModPOS.Ejecuta("sp_elimina_clasprod", "@Tipo", 4, "@Class", Linea, "@Producto", PROClave)

                        End If

                        If aSublinea > 0 AndAlso Sublinea = 0 Then
                            ModPOS.Ejecuta("sp_elimina_clasprod", "@Tipo", 4, "@Class", Sublinea, "@Producto", PROClave)
                        End If

                        'Si existia un registro en clasificacion y se cambia
                        If aMarca > 0 AndAlso Marca > 0 Then
                            ModPOS.Ejecuta("sp_actualiza_clasprod", "@Tipo", 3, "@ClassAntes", aMarca, "@ClassNueva", Marca, "@Producto", PROClave)
                        End If

                        If aLinea > 0 AndAlso Linea > 0 Then
                            ModPOS.Ejecuta("sp_actualiza_clasprod", "@Tipo", 4, "@ClassAntes", aLinea, "@ClassNueva", Linea, "@Producto", PROClave)

                        End If

                        If aSublinea > 0 AndAlso Sublinea > 0 Then
                            ModPOS.Ejecuta("sp_actualiza_clasprod", "@Tipo", 4, "@ClassAntes", aSublinea, "@ClassNueva", Sublinea, "@Producto", PROClave)
                        End If

                    End If

                    'Unidades
                    If ActualizaUnidad AndAlso dtUnidades.Rows.Count > 0 Then

                        ModPOS.Ejecuta("sp_elimina_productounidad", "@PROClave", PROClave)

                        Dim i As Integer
                        For i = 0 To dtUnidades.Rows.Count - 1
                            ModPOS.Ejecuta("sp_inserta_productounidad", _
                          "@UNDClave", dtUnidades.Rows(i)("ID"), _
                                                  "@PROClave", PROClave, _
                                                  "@GTIN", dtUnidades.Rows(i)("Barras"), _
                                                  "@Factor", dtUnidades.Rows(i)("Factor"), _
                                                  "@Volumen", dtUnidades.Rows(i)("Volumen"), _
                                                  "@Usuario", ModPOS.UsuarioActual)
                        Next
                        ActualizaUnidad = False
                    End If

                    'Precio
                    Me.actualizaPrecios(Ejecutar.Update)


                    'Si es un multiproducto


                    If Tipo = 3 Then

                        foundRows = dtMultiproducto.Select(" Baja = 1 ")

                        If foundRows.Length <> 0 Then

                            For z = 0 To foundRows.GetUpperBound(0)
                                ModPOS.Ejecuta("sp_elimina_proddet", "@MLTClave", foundRows(z)("ID"), "@Usuario", ModPOS.UsuarioActual)
                            Next
                        End If

                        foundRows = dtMultiproducto.Select(" Update = 1 and Baja = 0 ")
                        If foundRows.Length <> 0 Then
                            For z = 0 To foundRows.GetUpperBound(0)
                                ModPOS.Ejecuta("sp_actualiza_proddet", _
                                "@MLTClave", foundRows(z)("ID"), _
                                "@PROClavePadre", PROClave, _
                                "@PROClave", foundRows(z)("PROClave"), _
                                "@CantidadUnidades", foundRows(z)("Cantidad"), _
                                "@Estado", foundRows(z)("iEstado"), _
                                "@Usuario", ModPOS.UsuarioActual)
                            Next
                        End If
                    End If

                    'Equivalentes

                    foundRows = dtEquivalentes.Select(" Baja = 1 ")

                    If foundRows.Length <> 0 Then

                        For z = 0 To foundRows.GetUpperBound(0)
                            ModPOS.Ejecuta("sp_elimina_productoequivalente", "@PROClave", Me.PROClave, "@Equivalente", foundRows(z)("ID"))
                        Next
                    End If


                    foundRows = dtEquivalentes.Select(" Update = 1 and Baja = 0 ")

                    If foundRows.Length <> 0 Then
                        'inserta metodos de pago
                        For z = 0 To foundRows.GetUpperBound(0)
                            ModPOS.Ejecuta("sp_inserta_equivalente", _
                            "@PROClave", Me.PROClave, _
                            "@ProductoEquivalente", foundRows(z)("ID"), _
                            "@Usuario", ModPOS.UsuarioActual)
                        Next
                    End If



                    If PicLoad = True Then
                        Dim i As Integer
                        For i = 0 To Imagenes.Length - 1
                            If Imagenes(i) IsNot Nothing Then
                                If Imagenes(i).Nuevo = True Then
                                    If Imagenes(i).Estado = 1 Then
                                        ModPOS.Ejecuta("sp_inserta_imagen", "@PROClave", PROClave, "@IMGClave", Imagenes(i).IMGClave, "@Imagen", Imagenes(i).Foto, "@Usuario", ModPOS.UsuarioActual)
                                    End If
                                Else
                                    If Imagenes(i).Estado = 2 Then
                                        ModPOS.Ejecuta("sp_actualiza_imagen", "@PROClave", PROClave, "@IMGClave", Imagenes(i).IMGClave, "@Imagen", Imagenes(i).Foto, "@Usuario", ModPOS.UsuarioActual)
                                    ElseIf Imagenes(i).Estado = 0 Then
                                        ModPOS.Ejecuta("sp_remueve_imagen", "@PROClave", PROClave, "@IMGClave", Imagenes(i).IMGClave, "@Usuario", ModPOS.UsuarioActual)
                                    End If
                                End If
                            End If
                        Next
                    End If

                    If bIngreso = True Then
                        If Not ModPOS.Entrada Is Nothing Then
                            ModPOS.Entrada.leeCodigoBarras(Clave)
                        End If
                    End If
                    Me.Close()
            End Select
        Else
            Beep()
            MessageBox.Show("¡Alguno de los datos introducidos no es valido o es requerido!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
        End If

    End Sub

    Private Sub FrmProducto_Closing(ByVal sender As Object, ByVal e As System.ComponentModel.CancelEventArgs) Handles MyBase.Closing
        ModPOS.Producto.Dispose()
        ModPOS.Producto = Nothing

        If Not ModPOS.MtoProductos Is Nothing Then
            If Padre = "Agregar" Then
                ModPOS.MtoProductos.actualizaTree()

                If Not Me.CmbSubLinea.SelectedValue Is Nothing Then
                    ModPOS.MtoProductos.actGrid(CStr(Me.CmbSubLinea.SelectedValue))
                ElseIf CmbLinea.SelectedValue Is Nothing Then
                    ModPOS.MtoProductos.actGrid("0")
                Else
                    ModPOS.MtoProductos.actGrid(CStr(CmbLinea.SelectedValue))
                End If
            End If
        End If

    End Sub

    Private Sub UiTab1_SelectedTabChanged(ByVal sender As System.Object, ByVal e As Janus.Windows.UI.Tab.TabEventArgs) Handles UiTab1.SelectedTabChanged
        Select Case e.Page.Name
            Case "UiTabCosto"
                ModPOS.ActualizaGrid(False, Me.GridCostHist, "sp_muestra_costos", "@PROClave", PROClave)

                ModPOS.ActualizaGrid(True, GridPrv, "sp_muestra_prvpro", "@PROClave", PROClave)
                GridPrv.RootTable.Columns("ID").Visible = False
                GridPrv.RootTable.Columns("iEstado").Visible = False

                'Case "UiTabKits"
                '    If Padre = "Modificar" AndAlso CmbTipo.SelectedIndex = 2 Then
                '        ModPOS.ActualizaGrid(True, Me.GridMultiproducto, "sp_muestra_multiproductos", "@ProductoPadre", PROClave)

                '        Me.GridMultiproducto.RootTable.Columns("ID").Visible = False
                '    ElseIf CmbTipo.SelectedIndex = 2 Then
                '        BtnModProd.Enabled = False
                '    End If

                'Case "UiTabEquivalentes"
                '    ModPOS.ActualizaGrid(False, GridEquivalentes, "sp_muestra_equivalentes", "@PROClave", PROClave)
                '    GridEquivalentes.RootTable.Columns("ID").Visible = False
        End Select

    End Sub

    Private Sub BtnCancelar_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnCancelar.Click
        Me.Close()
    End Sub

#End Region

#Region "Multiproducto"

    Public Sub AddMultiproducto(ByVal sPROClave As String, ByVal sClave As String, ByVal sNombre As String, ByVal sUnidad As String, ByVal dCantidad As Double, ByVal iEstado As Integer, ByVal sEstado As String, ByVal TProducto As Integer)

        Dim foundRows() As Data.DataRow
        foundRows = dtMultiproducto.Select("PROClave Like '" & sPROClave & "' and Baja = 0 ")

        If foundRows.Length = 0 Then
            Dim row1 As DataRow
            row1 = ModPOS.Producto.dtMultiproducto.NewRow()
            'declara el nombre de la fila
            row1.Item("ID") = ModPOS.obtenerLlave
            row1.Item("PROClave") = sPROClave
            row1.Item("Clave") = sClave
            row1.Item("Nombre") = sNombre
            row1.Item("Unidad") = sUnidad
            row1.Item("Cantidad") = dCantidad
            row1.Item("Estado") = sEstado
            row1.Item("iEstado") = iEstado
            row1.Item("Update") = 1
            row1.Item("Baja") = 0
            row1.Item("TProducto") = TProducto

            dtMultiproducto.Rows.Add(row1)
            'agrega la fila completo a la tabla
        Else
            foundRows(0)("Cantidad") = dCantidad
            foundRows(0)("Estado") = sEstado
            foundRows(0)("iEstado") = iEstado
            foundRows(0)("Update") = 1
        End If

    End Sub

    Public Sub modificarDet()
        If sMLTSelected <> "" Then
            If GridMultiproducto.GetValue("Baja") = 0 Then

                If ModPOS.ProdDet Is Nothing Then

                    ModPOS.ProdDet = New FrmProdDet
                    With ModPOS.ProdDet
                        .Text = "Modificar Producto de Multiempaque"
                        .StartPosition = FormStartPosition.CenterScreen
                        .Padre = "Modificar"

                        .PROClavePadre = PROClave
                        .MLTClave = GridMultiproducto.GetValue("ID")
                        .PROClave = GridMultiproducto.GetValue("PROClave")
                        .Clave = GridMultiproducto.GetValue("Clave")
                        .Nombre = GridMultiproducto.GetValue("Nombre")
                        .Unidad = GridMultiproducto.GetValue("Unidad")
                        .CantidadUnidades = GridMultiproducto.GetValue("Cantidad")
                        .Estado = GridMultiproducto.GetValue("iEstado")
                        .TProducto = GridMultiproducto.GetValue("TProducto")


                    End With
                End If
                ModPOS.ProdDet.TxtClave.ReadOnly = True
                ModPOS.ProdDet.BtnBusqueda.Enabled = False
                ModPOS.ProdDet.StartPosition = FormStartPosition.CenterScreen
                ModPOS.ProdDet.Show()
                ModPOS.ProdDet.BringToFront()
            End If
        End If
    End Sub

    Private Sub GridMultiproducto_DoubleClick(ByVal sender As System.Object, ByVal e As System.EventArgs)
        modificarDet()
    End Sub


#End Region

#Region "Unidad de Venta"



    Private Sub BtnDelUnidad_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnDelUnidad.Click
        If GridUnidades.Row >= 0 Then
            Beep()
            Select Case MessageBox.Show("Se eliminara del producto actual la unidad de venta :" & GridUnidades.GetValue("Unidad"), "Advertencia", MessageBoxButtons.YesNo, MessageBoxIcon.Warning)
                Case DialogResult.Yes
                    Dim foundRows() As System.Data.DataRow
                    foundRows = dtUnidades.Select("Unidad Like '" & GridUnidades.GetValue("Unidad") & "'")

                    dtUnidades.Rows.Remove(foundRows(0))

                    If Padre = "Modificar" Then
                        ActualizaUnidad = True
                    End If
            End Select
        End If
    End Sub

    Private Sub GridUnidades_SelectionChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If Not GridUnidades.GetValue(0) Is Nothing Then
            Me.BtnDelUnidad.Enabled = True

            Me.sUnidad = GridUnidades.GetValue(0)
            Me.sUnidadNombre = GridUnidades.GetValue(2)
        Else
            Me.sUnidad = ""
            Me.sUnidadNombre = ""
            Me.BtnDelUnidad.Enabled = False
        End If

    End Sub


#End Region

#Region "Producto Equivalente"

    Public Sub AddEquivalente(ByVal sPROClave As String, ByVal sClave As String, ByVal sNombre As String, ByVal sDescripcion As String)

        Dim foundRows() As Data.DataRow
        foundRows = dtEquivalentes.Select("ID Like '" & sPROClave & "' and Baja = 0 ")

        If foundRows.Length = 0 Then
            Dim row1 As DataRow
            row1 = ModPOS.Producto.dtEquivalentes.NewRow()
            'declara el nombre de la fila
            row1.Item("ID") = sPROClave
            row1.Item("Clave") = sClave
            row1.Item("Nombre") = sNombre
            row1.Item("Descripción") = sDescripcion
            row1.Item("Update") = 1
            row1.Item("Baja") = 0

            dtEquivalentes.Rows.Add(row1)
            'agrega la fila completo a la tabla
        End If

    End Sub

    Private Sub BtnAddEquivalente_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnAddEquivalente.Click
        If ModPOS.ProductoEquivalente Is Nothing Then
            ModPOS.ProductoEquivalente = New FrmAddEquivalente
            With ModPOS.ProductoEquivalente
                .Text = "Agregar Productos Equivalentes"
                .StartPosition = FormStartPosition.CenterScreen
                .PROClave = Me.PROClave
            End With
        End If
        ModPOS.ProductoEquivalente.StartPosition = FormStartPosition.CenterScreen
        ModPOS.ProductoEquivalente.Show()
        ModPOS.ProductoEquivalente.BringToFront()

    End Sub

    Private Sub BtnDelEquivalente_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnDelEquivalente.Click
        If sEquivalente <> "" Then
            Beep()
            Select Case MessageBox.Show("Se eliminara del producto actual el producto equivalente :" & sProductoEquivalente, "Advertencia", MessageBoxButtons.YesNo, MessageBoxIcon.Warning)
                Case DialogResult.Yes

                    Dim foundRows() As System.Data.DataRow
                    foundRows = dtEquivalentes.Select("ID Like '" & sEquivalente & "'")

                    If foundRows.Length <> 0 Then
                        foundRows(0)("Baja") = 1
                    End If

            End Select
        End If

    End Sub

    Private Sub GridEquivalentes_SelectionChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles GridEquivalentes.SelectionChanged
        If Not GridEquivalentes.GetValue(0) Is Nothing Then
            Me.BtnDelEquivalente.Enabled = True

            Me.sEquivalente = GridEquivalentes.GetValue(0)
            Me.sProductoEquivalente = GridEquivalentes.GetValue(2)
        Else
            Me.sEquivalente = ""
            Me.sProductoEquivalente = ""
            Me.BtnDelEquivalente.Enabled = False
        End If
    End Sub

#End Region

    Private Sub RecuperaImagenProducto()
        Dim dt As DataTable
        dt = ModPOS.Recupera_Tabla("sp_recupera_imagenes", "@PROClave", PROClave)
        If dt.Rows.Count > 0 Then
            PicProducto.Image = ModPOS.RecuperaIcono(CType(dt.Rows(0)("Imagen"), Byte()))
        End If
        dt.Dispose()
    End Sub

    Private Sub Ctrl_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles TxtClave.KeyDown, TxtDescripcion.KeyDown, TxtNombre.KeyDown, cmbCosto.KeyDown, TxtNumParte.KeyDown, CmbLinea.KeyDown, CmbMarca.KeyDown, CmbSubLinea.KeyDown, UiTab1.KeyDown

        If e.KeyCode = Keys.Enter Then
            e.Handled = True
            SendKeys.Send("{TAB}")

            'If Not Me.GetNextControl(sender, True) Is Nothing Then Me.GetNextControl(sender, True).Focus()
        End If
    End Sub

    Private Sub CmbLinea_SelectedValueChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles CmbLinea.SelectedValueChanged
        If Not CmbLinea.SelectedValue Is Nothing AndAlso lineaCargada Then
            With Me.CmbSubLinea
                .Conexion = ModPOS.BDConexion
                .ProcedimientoAlmacenado = "sp_filtra_sublinea"
                .NombreParametro1 = "CLAClavePadre"
                .Parametro1 = CmbLinea.SelectedValue
                .llenar()
            End With
        End If
    End Sub

    Private Sub GridPrecios_CellEdited(ByVal sender As Object, ByVal e As Janus.Windows.GridEX.ColumnActionEventArgs) Handles GridPrecios.CellEdited

        If GridPrecios.CurrentColumn.Caption = "Neto" Then
            If IsNumeric(GridPrecios.GetValue("Neto")) AndAlso GridPrecios.GetValue("Neto") >= (GridPrecios.GetValue("CostoRef") * RecuperaImpuesto(1)) Then

                If GridPrecios.GetValue("CostoRef") = 0 Then
                    GridPrecios.SetValue("Neto", Redondear(GridPrecios.GetValue("Precio") * RecuperaImpuesto(1), 2))
                    GridPrecios.SetValue("Frontera", Redondear(GridPrecios.GetValue("Precio") * RecuperaImpuesto(2), 2))
                    Beep()
                    MessageBox.Show("¡El Costo debe ser mayor a cero!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
                    Exit Sub
                End If

                Dim dPrecio As Double
                dPrecio = GridPrecios.GetValue("Neto") / RecuperaImpuesto(1)
                GridPrecios.SetValue("Precio", Redondear(dPrecio, 2))
                GridPrecios.SetValue("Factor", Redondear((dPrecio / GridPrecios.GetValue("CostoRef") - 1) * 100, 2))

                GridPrecios.SetValue("Frontera", Redondear(dPrecio * RecuperaImpuesto(2), 2))

                ActualizaNeto = True
            Else
                GridPrecios.SetValue("Neto", Redondear(GridPrecios.GetValue("Precio") * RecuperaImpuesto(1), 2))
                GridPrecios.SetValue("Frontera", Redondear(GridPrecios.GetValue("Precio") * RecuperaImpuesto(2), 2))

                Beep()
                MessageBox.Show("¡El Precio Neto debe ser mayor o igual al Costo más Impuestos!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
            End If
        End If

        If GridPrecios.CurrentColumn.Caption = "Factor" Then
            Dim dPrecio As Double
            If IsNumeric(GridPrecios.GetValue("Factor")) AndAlso GridPrecios.GetValue("Factor") >= 0 Then

                If GridPrecios.GetValue("CostoRef") = 0 Then
                    GridPrecios.SetValue("Factor", GridPrecios.GetValue("Fbase"))
                    dPrecio = GridPrecios.GetValue("CostoRef") * (1 + (GridPrecios.GetValue("Factor") / 100))
                    GridPrecios.SetValue("Precio", Redondear(dPrecio, 2))
                    GridPrecios.SetValue("Neto", Redondear(dPrecio * RecuperaImpuesto(1), 2))
                    GridPrecios.SetValue("Frontera", Redondear(dPrecio * RecuperaImpuesto(2), 2))

                    Beep()
                    MessageBox.Show("¡El Costo debe ser mayor a cero!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
                    Exit Sub
                End If

                If GridPrecios.GetValue("Factor") = 0 Then
                    dPrecio = GridPrecios.GetValue("CostoRef")
                Else
                    dPrecio = GridPrecios.GetValue("CostoRef") * (1 + (GridPrecios.GetValue("Factor") / 100))
                End If
                GridPrecios.SetValue("Precio", Redondear(dPrecio, 2))
                GridPrecios.SetValue("Neto", Redondear(dPrecio * RecuperaImpuesto(1), 2))
                GridPrecios.SetValue("Frontera", Redondear(dPrecio * RecuperaImpuesto(2), 2))

                ActualizaNeto = True
            Else
                GridPrecios.SetValue("Factor", GridPrecios.GetValue("Fbase"))
                dPrecio = GridPrecios.GetValue("CostoRef") * (1 + (GridPrecios.GetValue("Factor") / 100))
                GridPrecios.SetValue("Precio", Redondear(dPrecio, 2))
                GridPrecios.SetValue("Neto", Redondear(dPrecio * RecuperaImpuesto(1), 2))
                GridPrecios.SetValue("Frontera", Redondear(dPrecio * RecuperaImpuesto(2), 2))

                Beep()
                MessageBox.Show("¡El factor de utilidad no puede ser menor a cero!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
            End If
        End If

        If GridPrecios.CurrentColumn.Caption = "Precio" Then
            If IsNumeric(GridPrecios.GetValue("Precio")) AndAlso GridPrecios.GetValue("Precio") >= GridPrecios.GetValue("CostoRef") Then

                If GridPrecios.GetValue("CostoRef") = 0 Then
                    GridPrecios.SetValue("Precio", Redondear(GridPrecios.GetValue("CostoRef") * (1 + (GridPrecios.GetValue("Factor") / 100)), 2))
                    Beep()
                    MessageBox.Show("¡El Costo debe ser mayor a cero!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
                    Exit Sub
                End If

                If GridPrecios.GetValue("Precio") = GridPrecios.GetValue("CostoRef") Then
                    GridPrecios.SetValue("Factor", 0)
                Else
                    GridPrecios.SetValue("Factor", Redondear((GridPrecios.GetValue("Precio") / GridPrecios.GetValue("CostoRef") - 1) * 100, 2))
                End If
                GridPrecios.SetValue("Neto", Redondear(GridPrecios.GetValue("Precio") * RecuperaImpuesto(1), 2))
                GridPrecios.SetValue("Frontera", Redondear(GridPrecios.GetValue("Precio") * RecuperaImpuesto(2), 2))

                ActualizaNeto = True
            Else
                GridPrecios.SetValue("Precio", Redondear(GridPrecios.GetValue("CostoRef") * (1 + (GridPrecios.GetValue("Factor") / 100)), 2))
                Beep()
                MessageBox.Show("¡El Precio debe ser mayor o igual al Costo!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
            End If
        End If
    End Sub

    Public Sub AddUnidad(ByVal CodigoBarras As String, ByVal Factor As Integer, ByVal Tipo As String, ByVal Unidad As String, ByVal Volumen As Double)
        If ModPOS.SiExite(ModPOS.BDConexion, "sp_valida_gtin", "@PROClave", PROClave, "@GTIN", CodigoBarras.ToUpper.Trim) = 0 Then

            Dim foundRows() As Data.DataRow
            foundRows = dtUnidades.Select("ID Like '" & Tipo & "'")

            If foundRows.Length = 0 Then
                foundRows = dtUnidades.Select("Barras Like '" & CodigoBarras.ToUpper.Trim & "'")
                If foundRows.Length = 0 Then
                    foundRows = dtUnidades.Select("Factor =" & CStr(Factor))
                    If foundRows.Length = 0 Then
                        Dim row1 As DataRow
                        row1 = dtUnidades.NewRow()
                        'declara el nombre de la fila

                        row1.Item("ID") = Tipo
                        row1.Item("Unidad") = Unidad
                        row1.Item("Factor") = Factor
                        row1.Item("EAN") = CodigoBarras.ToUpper.Trim
                        row1.Item("Barras") = CodigoBarras.ToUpper.Trim
                        row1.Item("Volumen") = Volumen
                        dtUnidades.Rows.Add(row1)
                        'agrega la fila completo a la tabla

                        If Padre = "Modificar" Then
                            ActualizaUnidad = True
                        End If
                    Else
                        Beep()
                        MessageBox.Show("¡El Factor que intenta agregar ya existe para el producto actual!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
                    End If
                Else
                    Beep()
                    MessageBox.Show("¡El Código de Barras que intenta agregar ya existe para el producto actual!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
                End If
            Else
                Beep()
                MessageBox.Show("¡La Unidad de venta que intenta agregar ya existe para el producto actual!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
            End If
        Else
            Beep()
            MessageBox.Show("¡El Código de Barras que intenta agregar ya existe en otro producto!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
        End If
    End Sub

    Public Sub ActualizaImagenes(ByVal Array() As Foto)
        PicLoad = True
        Imagenes = Array

        Dim i As Integer
        For i = 0 To Imagenes.Length - 1
            If Imagenes(i) IsNot Nothing Then
                If Imagenes(i).Estado = 1 OrElse Imagenes(i).Estado = 2 Then
                    PicProducto.Image = ModPOS.RecuperaIcono(Imagenes(i).Foto)
                    Exit For
                End If
            End If
        Next

    End Sub


    Private Sub GridUnidades_CellEdited(ByVal sender As Object, ByVal e As Janus.Windows.GridEX.ColumnActionEventArgs) Handles GridUnidades.CellEdited

        If GridUnidades.CurrentColumn.Caption = "Barras" Then

            If GridUnidades.GetValue("Barras") Is System.DBNull.Value Then
                GridUnidades.SetValue("Barras", GridUnidades.GetValue("EAN"))

            ElseIf ModPOS.SiExite(ModPOS.BDConexion, "sp_valida_gtin", "@PROClave", PROClave, "@GTIN", GridUnidades.GetValue("Barras")) = 0 Then
                Dim foundRows() As Data.DataRow
                foundRows = dtUnidades.Select("Barras Like '" & GridUnidades.GetValue("Barras") & "'")
                If foundRows.Length = 0 Then
                    GridUnidades.SetValue("EAN", GridUnidades.GetValue("Barras"))
                    If Padre = "Modificar" Then
                        ActualizaUnidad = True
                    End If
                Else
                    If GridUnidades.GetValue("EAN") <> GridUnidades.GetValue("Barras") Then
                        Beep()
                        MessageBox.Show("¡El Código de Barras que intenta agregar ya existe para el producto actual!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
                        GridUnidades.SetValue("Barras", GridUnidades.GetValue("EAN"))
                    End If
                End If
            Else
                Beep()
                MessageBox.Show("¡El Código de Barras que intenta agregar ya existe en otro producto!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Stop)
                GridUnidades.SetValue("Barras", GridUnidades.GetValue("EAN"))
            End If
        ElseIf GridUnidades.CurrentColumn.Caption = "Volumen" Then
            If IsNumeric(GridUnidades.GetValue("Volumen")) Then
                ActualizaUnidad = True
            Else
                GridUnidades.SetValue("Volumen", 1)
            End If
        End If


    End Sub

    Private Sub CmbTipo_SelectedIndexChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)
        If Not CmbTipo.SelectedValue Is Nothing AndAlso CmbTipo.SelectedIndex = 2 Then
            UiTabKits.Enabled = True
        Else
            UiTabKits.Enabled = False
        End If
    End Sub

    Private Sub BtnAddProd_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnAddProd.Click
        If ModPOS.ProdDet Is Nothing Then
            ModPOS.ProdDet = New FrmProdDet
            With ModPOS.ProdDet
                .Text = "Agregar Producto a Multiempaque"
                .StartPosition = FormStartPosition.CenterScreen
                .Padre = "Agregar"
                .SubPadre = Padre
                .Estado = 1
                .ChkEstado.Enabled = True
                .PROClavePadre = Me.PROClave
            End With
        End If
        ModPOS.ProdDet.StartPosition = FormStartPosition.CenterScreen
        ModPOS.ProdDet.Show()
        ModPOS.ProdDet.BringToFront()

    End Sub

    Private Sub BtnModProd_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnModProd.Click
        modificarDet()

    End Sub

    Private Sub BtnDelProd_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnDelProd.Click

        If Me.sMLTSelected <> "" Then
            Beep()
            Select Case MessageBox.Show("Se eliminara el Producto: " & sNombre, "Advertencia", MessageBoxButtons.YesNo, MessageBoxIcon.Warning)
                Case DialogResult.Yes

                    Dim foundRows() As System.Data.DataRow
                    foundRows = dtMultiproducto.Select("ID Like '" & sMLTSelected & "'")

                    If foundRows.Length <> 0 Then
                        foundRows(0)("Baja") = 1
                    End If

                Case DialogResult.No

            End Select
        End If

    End Sub

    Private Sub GridMultiproducto_DoubleClick1(ByVal sender As Object, ByVal e As System.EventArgs) Handles GridMultiproducto.DoubleClick
        Me.modificarDet()
    End Sub

    Private Sub GridMultiproducto_SelectionChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles GridMultiproducto.SelectionChanged
        If Not GridMultiproducto.GetValue(0) Is Nothing Then
            Me.BtnModProd.Enabled = True
            Me.BtnDelProd.Enabled = True
            Me.sMLTSelected = GridMultiproducto.GetValue("ID")
            Me.sNombre = GridMultiproducto.GetValue("Clave")
        Else
            Me.sMLTSelected = ""
            Me.sNombre = ""
            Me.BtnModProd.Enabled = False
            Me.BtnDelProd.Enabled = False
        End If

    End Sub

    Private Sub CmbSeguimiento_SelectedValueChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles CmbSeguimiento.SelectedValueChanged
        If Not CmbSeguimiento.SelectedValue Is Nothing AndAlso lineaCargada Then
            If CmbSeguimiento.SelectedValue = 2 Then
                TxtDiasGarantia.Enabled = True
                TxtDiasGarantia.Text = "0"
            Else
                TxtDiasGarantia.Enabled = False
                TxtDiasGarantia.Text = "0"
            End If
        End If
    End Sub

    Private Sub BtnReemplazo_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnReemplazo.Click
        Dim a As New MeRemplazoClave
        a.Clave = Clave
        a.ShowDialog()
        If a.DialogResult = DialogResult.OK Then
            Me.TxtClave.Text = a.NuevaClave
        End If
        a.Dispose()
    End Sub

    Private Sub BtnKey_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnKey.Click
        Dim dt As DataTable
        dt = ModPOS.Recupera_Tabla("sp_recupera_comparam", "@PARClave", "Digitos", "@COMClave", ModPOS.CompanyActual)
        Dim len As Integer = CInt(dt.Rows(0)("Valor"))
        dt.Dispose()
        Dim CLAClave As Integer

        If Not CmbSubLinea.SelectedValue Is Nothing Then
            CLAClave = CmbSubLinea.SelectedValue
        ElseIf Not CmbLinea.SelectedValue Is Nothing Then
            CLAClave = CmbLinea.SelectedValue
        Else
            CLAClave = 0
        End If

        dt = ModPOS.Recupera_Tabla("sp_calcula_proclave", "@CLAClave", CLAClave, "@len", len, "@COMClave", ModPOS.CompanyActual)

        If Not dt Is Nothing Then
            If dt.Rows.Count > 0 Then
                TxtClave.Text = dt.Rows(0)("Clave")
            Else
                MessageBox.Show("No fue posible sugerir Clave", "Información", MessageBoxButtons.OK, MessageBoxIcon.Information)
            End If
            dt.Dispose()
        Else
            MessageBox.Show("No fue posible sugerir Clave", "Información", MessageBoxButtons.OK, MessageBoxIcon.Information)
        End If

        TxtNombre.Focus()

    End Sub

    Public Sub ModCosto(ByVal Cost As Double)
        Me.TxtCost.Text = CStr(Cost)

        If Not Cost = ModPOS.Redondear(tmpCosto, 2) Then
            If Cost > ModPOS.Redondear(tmpCosto, 2) Then

                Select Case MessageBox.Show("Se ha modificado el costo. ¿Desea recalcular el precio de todas las listas?", "Pregunta", MessageBoxButtons.YesNo, MessageBoxIcon.Question)
                    Case System.Windows.Forms.DialogResult.Yes
                        Dim i As Integer
                        For i = 0 To dtPrecios.Rows.Count - 1
                            dtPrecios.Rows(i)("CostoRef") = Math.Abs(Cost)
                            If dtPrecios.Rows(i)("Factor") = 0 Then
                                dtPrecios.Rows(i)("Precio") = dtPrecios.Rows(i)("CostoRef")
                            Else
                                dtPrecios.Rows(i)("Precio") = Redondear(Math.Abs(Cost) * (1 + IIf(dtPrecios.Rows(i)("Factor") < 0, 1, dtPrecios.Rows(i)("Factor")) / 100), 2)
                            End If
                            dtPrecios.Rows(i)("Neto") = Redondear(dtPrecios.Rows(i)("Precio") * RecuperaImpuesto(1), 2)
                            dtPrecios.Rows(i)("Frontera") = Redondear(dtPrecios.Rows(i)("Precio") * RecuperaImpuesto(2), 2)

                        Next
                    Case System.Windows.Forms.DialogResult.No
                        'Recalcula Utilidad
                        Dim i As Integer
                        For i = 0 To dtPrecios.Rows.Count - 1
                            If (Math.Abs(Cost) * RecuperaImpuesto(1)) > dtPrecios.Rows(i)("Neto") Then
                                dtPrecios.Rows(i)("CostoRef") = Math.Abs(Cost)
                                dtPrecios.Rows(i)("Factor") = 0
                                dtPrecios.Rows(i)("Precio") = Redondear(Math.Abs(Cost), 2)
                                dtPrecios.Rows(i)("Neto") = Redondear(dtPrecios.Rows(i)("Precio") * RecuperaImpuesto(2), 2)
                                dtPrecios.Rows(i)("Frontera") = Redondear(dtPrecios.Rows(i)("Precio") * RecuperaImpuesto(2), 2)

                            Else
                                dtPrecios.Rows(i)("CostoRef") = Math.Abs(Cost)
                                dtPrecios.Rows(i)("Factor") = Redondear((dtPrecios.Rows(i)("Precio") / Math.Abs(Cost)) - 1, 2) * 100
                            End If
                        Next
                End Select
            Else
                Select Case MessageBox.Show("Se ha modificado el costo. ¿Desea recalcular el precio de todas las listas?", "Pregunta", MessageBoxButtons.YesNo, MessageBoxIcon.Question)
                    Case System.Windows.Forms.DialogResult.Yes
                        Dim i As Integer
                        For i = 0 To dtPrecios.Rows.Count - 1
                            dtPrecios.Rows(i)("CostoRef") = Math.Abs(Cost)
                            If dtPrecios.Rows(i)("Factor") = 0 Then
                                dtPrecios.Rows(i)("Precio") = dtPrecios.Rows(i)("CostoRef")
                            Else
                                dtPrecios.Rows(i)("Precio") = Redondear(Math.Abs(Cost) * (1 + IIf(dtPrecios.Rows(i)("Factor") < 0, 1, dtPrecios.Rows(i)("Factor")) / 100), 2)
                            End If
                            dtPrecios.Rows(i)("Neto") = Redondear(dtPrecios.Rows(i)("Precio") * RecuperaImpuesto(1), 2)
                            dtPrecios.Rows(i)("Frontera") = Redondear(dtPrecios.Rows(i)("Precio") * RecuperaImpuesto(2), 2)

                        Next
                    Case System.Windows.Forms.DialogResult.No
                        'Recalcula Utilidad
                        Dim i As Integer
                        For i = 0 To dtPrecios.Rows.Count - 1
                            dtPrecios.Rows(i)("CostoRef") = Math.Abs(Cost)
                            dtPrecios.Rows(i)("Factor") = Redondear((dtPrecios.Rows(i)("Precio") / Math.Abs(Cost)) - 1, 2) * 100
                        Next
                End Select
            End If
            tmpCosto = Cost
        End If
    End Sub

    Private Sub BtnAddPrv_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnAddPrv.Click
        If ModPOS.PrvProd Is Nothing Then
            ModPOS.PrvProd = New FrmPrvProd
            With ModPOS.PrvProd
                .PROClave = PROClave
                .Padre = "Agregar"
            End With
        End If
        ModPOS.PrvProd.StartPosition = FormStartPosition.CenterScreen
        ModPOS.PrvProd.Show()
        ModPOS.PrvProd.BringToFront()
    End Sub

    Private Sub BtnModificar_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnModificar.Click
        modificarPrv()
    End Sub

    Private Sub GridPrv_DoubleClick(ByVal sender As Object, ByVal e As System.EventArgs) Handles GridPrv.DoubleClick
        modificarPrv()
    End Sub

    Private Sub GridPrv_SelectionChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles GridPrv.SelectionChanged
        If Not GridPrv.GetValue(0) Is Nothing Then
            Me.BtnModificar.Enabled = True
            Me.sPrvSelected = GridPrv.GetValue("ID")
            Me.sClavePrv = GridPrv.GetValue("Clave")
            Me.sRazonSocialPrv = GridPrv.GetValue("Razón Social")
            Me.dDescuentoPrv = GridPrv.GetValue("%Desc.")
            Me.iEstado = GridPrv.GetValue("iEstado")
        Else
            Me.sPrvSelected = ""
            Me.sClavePrv = ""
            Me.sRazonSocialPrv = ""
            Me.dDescuentoPrv = 0
            Me.iEstado = 0
            Me.BtnModificar.Enabled = False

        End If
    End Sub

    Public Sub modificarPrv()
        If sPrvSelected <> "" Then

            If ModPOS.PrvProd Is Nothing Then

                ModPOS.PrvProd = New FrmPrvProd
                With ModPOS.PrvProd
                    .PROClave = Me.PROClave
                    .Padre = "Modificar"
                    .BtnBuscaPrv.Enabled = False
                    .TxtClave.ReadOnly = True
                    .PRVClave = sPrvSelected
                    .PROClave = PROClave
                    .Clave = sClavePrv
                    .RazonSocial = sRazonSocialPrv
                    .Descuento = dDescuentoPrv
                    .Estado = iEstado
                    .TxtDescuento.Focus()
                End With
            End If
            ModPOS.PrvProd.StartPosition = FormStartPosition.CenterScreen
            ModPOS.PrvProd.Show()
            ModPOS.PrvProd.BringToFront()
        End If
    End Sub

    Private Sub BtnAddUnidad_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnAddUnidad.Click
        Dim a As New FrmAddUnidad
        a.Clave = TxtClave.Text
        a.ShowDialog()
    End Sub

    Private Sub ChkMarcaTodos_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ChkMarcaTodos.CheckedChanged
        If dtImpuesto.Rows.Count > 0 Then
            Dim i As Integer
            If ChkMarcaTodos.Checked Then
                For i = 0 To dtImpuesto.Rows.Count - 1
                    dtImpuesto.Rows(i)("Marca") = True
                Next
            Else
                For i = 0 To dtImpuesto.Rows.Count - 1
                    dtImpuesto.Rows(i)("Marca") = False
                Next
            End If
        End If
    End Sub

    Private Sub PicProducto_DoubleClick(ByVal sender As Object, ByVal e As System.EventArgs) Handles PicProducto.DoubleClick
        Dim a As New FrmPicture
        a.ClaveProducto = TxtClave.Text
        a.NombreProducto = TxtNombre.Text
        a.PROClave = Me.PROClave
        a.Padre = "Producto"
        a.ShowDialog()
        a.Dispose()

    End Sub

    Private Sub BtnCosto_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnCosto.Click
        Dim a As New FrmModCosto
        a.PROClave = PROClave
        a.Padre = Padre
        a.Costo = CDbl(TxtCost.Text)
        a.ShowDialog()
    End Sub

    Private Sub TxtNombre_Leave(ByVal sender As Object, ByVal e As System.EventArgs) Handles TxtNombre.Leave
        If TxtNombre.Text <> "" Then
            TxtDescripcion.Text = TxtNombre.Text
        End If
    End Sub

    Private Sub GridImpuestos_CellEdited(ByVal sender As Object, ByVal e As Janus.Windows.GridEX.ColumnActionEventArgs) Handles GridImpuestos.CellEdited
        Dim i As Integer
        For i = 0 To dtPrecios.Rows.Count - 1
            dtPrecios.Rows(i)("Neto") = Redondear(dtPrecios.Rows(i)("Precio") * RecuperaImpuesto(1), 2)
            dtPrecios.Rows(i)("Frontera") = Redondear(dtPrecios.Rows(i)("Precio") * RecuperaImpuesto(2), 2)
        Next
        ActualizaNeto = True
    End Sub

    Protected Overrides Sub Finalize()
        MyBase.Finalize()
    End Sub

    Private Sub GridImpuestos_CellValueChanged(ByVal sender As Object, ByVal e As Janus.Windows.GridEX.ColumnActionEventArgs) Handles GridImpuestos.CellValueChanged

        If GridImpuestos.Row = 0 Then
            GridImpuestos.MoveNext()
            GridImpuestos.MovePrevious()
        Else
            GridImpuestos.MovePrevious()
            GridImpuestos.MoveNext()
        End If

    End Sub

 
End Class
